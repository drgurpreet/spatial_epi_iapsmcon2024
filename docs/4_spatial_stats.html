<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Hands-on Workshop on Spatial Epidemiology using R: IPASMCON 2024 - Spatial Statistics in Epidemiology</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href=".//images/nwhda_hex.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a href="./index.html" class="navbar-brand navbar-brand-logo">
    <img src="./images/spatial_hex.png" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Hands-on Workshop on Spatial Epidemiology using R: IPASMCON 2024</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html" rel="" target="">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./1_intro.html" rel="" target="">
 <span class="menu-text">Introduction to Spatial Epidemiology</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./2_visualization.html" rel="" target="">
 <span class="menu-text">Spatial Data Visualization in Epidemiology</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./3_data_mgmt.html" rel="" target="">
 <span class="menu-text">Spatial Data Management</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="./4_spatial_stats.html" rel="" target="" aria-current="page">
 <span class="menu-text">Spatial Statistics in Epidemiology</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./5_gwr.html" rel="" target="">
 <span class="menu-text">Spatial Regression models: An introduction</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools ms-auto">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar"><div class="quarto-margin-header"><div class="margin-header-item">
<p><img src=".\images/spatial_hex.png" class="img-fluid" style="width:65.0%"></p>
</div></div>
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#expectations-from-the-present-session." id="toc-expectations-from-the-present-session." class="nav-link active" data-scroll-target="#expectations-from-the-present-session.">Expectations from the present session.</a></li>
  <li><a href="#complete-spatial-randomness-csr." id="toc-complete-spatial-randomness-csr." class="nav-link" data-scroll-target="#complete-spatial-randomness-csr.">Complete Spatial Randomness (CSR).</a></li>
  <li><a href="#stationarity." id="toc-stationarity." class="nav-link" data-scroll-target="#stationarity.">Stationarity.</a></li>
  <li><a href="#isotropy." id="toc-isotropy." class="nav-link" data-scroll-target="#isotropy.">Isotropy.</a></li>
  <li><a href="#spatial-cluster." id="toc-spatial-cluster." class="nav-link" data-scroll-target="#spatial-cluster.">Spatial Cluster.</a></li>
  <li><a href="#first-and-second-order-effects." id="toc-first-and-second-order-effects." class="nav-link" data-scroll-target="#first-and-second-order-effects.">First and second order effects.</a></li>
  <li><a href="#global-measures-of-spatial-clustering." id="toc-global-measures-of-spatial-clustering." class="nav-link" data-scroll-target="#global-measures-of-spatial-clustering.">Global measures of Spatial Clustering.</a></li>
  <li><a href="#local-measures-of-spatial-clustering." id="toc-local-measures-of-spatial-clustering." class="nav-link" data-scroll-target="#local-measures-of-spatial-clustering.">Local measures of Spatial Clustering.</a></li>
  <li><a href="#scan-circles." id="toc-scan-circles." class="nav-link" data-scroll-target="#scan-circles.">Scan circles.</a></li>
  <li><a href="#neighbours" id="toc-neighbours" class="nav-link" data-scroll-target="#neighbours">Neighbours</a>
  <ul class="collapse">
  <li><a href="#neighbours-defined-on-basis-of-adjacency-contiguity" id="toc-neighbours-defined-on-basis-of-adjacency-contiguity" class="nav-link" data-scroll-target="#neighbours-defined-on-basis-of-adjacency-contiguity">Neighbours defined on basis of adjacency/ contiguity</a></li>
  <li><a href="#neighbours-defined-on-basis-of-distance." id="toc-neighbours-defined-on-basis-of-distance." class="nav-link" data-scroll-target="#neighbours-defined-on-basis-of-distance.">Neighbours defined on basis of distance.</a></li>
  </ul></li>
  <li><a href="#monte-carlo-simulations." id="toc-monte-carlo-simulations." class="nav-link" data-scroll-target="#monte-carlo-simulations.">Monte Carlo simulations.</a></li>
  <li><a href="#measures-of-spatial-clustering-for-agggregated-data." id="toc-measures-of-spatial-clustering-for-agggregated-data." class="nav-link" data-scroll-target="#measures-of-spatial-clustering-for-agggregated-data.">Measures of Spatial Clustering for agggregated data.</a></li>
  <li><a href="#global-estimates." id="toc-global-estimates." class="nav-link" data-scroll-target="#global-estimates.">Global estimates.</a>
  <ul class="collapse">
  <li><a href="#morans-i." id="toc-morans-i." class="nav-link" data-scroll-target="#morans-i.">Moran’s I.</a></li>
  </ul></li>
  <li><a href="#local-estimates." id="toc-local-estimates." class="nav-link" data-scroll-target="#local-estimates.">Local estimates.</a>
  <ul class="collapse">
  <li><a href="#local-moran-test." id="toc-local-moran-test." class="nav-link" data-scroll-target="#local-moran-test.">Local Moran test.</a></li>
  </ul></li>
  <li><a href="#illustrative-example-morans-i-and-lisa-statistics" id="toc-illustrative-example-morans-i-and-lisa-statistics" class="nav-link" data-scroll-target="#illustrative-example-morans-i-and-lisa-statistics">Illustrative example: Moran’s I and LISA statistics</a></li>
  <li><a href="#point-pattern-analysis." id="toc-point-pattern-analysis." class="nav-link" data-scroll-target="#point-pattern-analysis.">Point pattern analysis.</a></li>
  <li><a href="#measures-of-spatial-clustering-around-a-source-focused-tests." id="toc-measures-of-spatial-clustering-around-a-source-focused-tests." class="nav-link" data-scroll-target="#measures-of-spatial-clustering-around-a-source-focused-tests.">Measures of Spatial clustering around a source (Focused tests).</a></li>
  <li><a href="#spatial-variation-in-risk." id="toc-spatial-variation-in-risk." class="nav-link" data-scroll-target="#spatial-variation-in-risk.">Spatial variation in risk.</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Spatial Statistics in Epidemiology</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>
<p>Welcome to the world of Spatial Epidemiology!!</p>
<p>The descriptive measures in routine data analysis includes measures of central tendency (e.g.&nbsp;mean, median, mode) and measures of dispersion such as (e.g.&nbsp;SD, range, IQR). The choice of the descriptive measure chosen to describe the study variable depends upon the type of data and on the scale of measurement. While describing spatial datasets, these known measures of describing a study variable are complemented with additional summary measures to describe spatial data.</p>
<div class="cell" data-hash="4_spatial_stats_cache/html/unnamed-chunk-1_8b563c9abc4bb59e3c1f56e2e8974246">
<div class="cell-output cell-output-stdout">
<pre><code>
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |==                                                                    |   3%
  |                                                                            
  |====                                                                  |   6%
  |                                                                            
  |======                                                                |   8%
  |                                                                            
  |========                                                              |  11%
  |                                                                            
  |==========                                                            |  14%
  |                                                                            
  |============                                                          |  17%
  |                                                                            
  |==============                                                        |  19%
  |                                                                            
  |================                                                      |  22%
  |                                                                            
  |==================                                                    |  25%
  |                                                                            
  |===================                                                   |  28%
  |                                                                            
  |=====================                                                 |  31%
  |                                                                            
  |=======================                                               |  33%
  |                                                                            
  |=========================                                             |  36%
  |                                                                            
  |===========================                                           |  39%
  |                                                                            
  |=============================                                         |  42%
  |                                                                            
  |===============================                                       |  44%
  |                                                                            
  |=================================                                     |  47%
  |                                                                            
  |===================================                                   |  50%
  |                                                                            
  |=====================================                                 |  53%
  |                                                                            
  |=======================================                               |  56%
  |                                                                            
  |=========================================                             |  58%
  |                                                                            
  |===========================================                           |  61%
  |                                                                            
  |=============================================                         |  64%
  |                                                                            
  |===============================================                       |  67%
  |                                                                            
  |=================================================                     |  69%
  |                                                                            
  |===================================================                   |  72%
  |                                                                            
  |====================================================                  |  75%
  |                                                                            
  |======================================================                |  78%
  |                                                                            
  |========================================================              |  81%
  |                                                                            
  |==========================================================            |  83%
  |                                                                            
  |============================================================          |  86%
  |                                                                            
  |==============================================================        |  89%
  |                                                                            
  |================================================================      |  92%
  |                                                                            
  |==================================================================    |  94%
  |                                                                            
  |====================================================================  |  97%
  |                                                                            
  |======================================================================| 100%</code></pre>
</div>
</div>
<section id="expectations-from-the-present-session." class="level2">
<h2 class="anchored" data-anchor-id="expectations-from-the-present-session.">Expectations from the present session.</h2>
<p>By the end of the session, students should be able to understand methods which are used to describe spatial distribution of study variable. The students are also expected to understand the difference in concept as well as methods in describing global estimates as compared to local estimates for presence of spatial clustering, if any.</p>
</section>
<section id="complete-spatial-randomness-csr." class="level2">
<h2 class="anchored" data-anchor-id="complete-spatial-randomness-csr.">Complete Spatial Randomness (CSR).</h2>
<p>It is also known as “Random Spatial Distribution” or “Independent Spatial Distribution”. When there is no spatial dependence, an event is expected to have CSR. Lack of CSR indicates spatial clustering.</p>
</section>
<section id="stationarity." class="level2">
<h2 class="anchored" data-anchor-id="stationarity.">Stationarity.</h2>
<p>A spatial process is said to be stationary when the dependence between measurements of the same variable across space is the same for all locations in an area. When the event occurrence is in CSR or in a regular pattern, the underlying process is said to be stationary.</p>
</section>
<section id="isotropy." class="level2">
<h2 class="anchored" data-anchor-id="isotropy.">Isotropy.</h2>
<p>If the dependence in a stationary process is affected by distance, but this is the same in all directions, the process is considered to be isotropic. When the stationary process is affected by distance and is not same in all directions, the process is considered to be anisotropic.</p>
</section>
<section id="spatial-cluster." class="level2">
<h2 class="anchored" data-anchor-id="spatial-cluster.">Spatial Cluster.</h2>
<p>Knox defined a cluster as “a geographically and/or temporally bounded group of occurrences of sufficient size and concentration to be unlikely to have occurred by chance”.</p>
</section>
<section id="first-and-second-order-effects." class="level2">
<h2 class="anchored" data-anchor-id="first-and-second-order-effects.">First and second order effects.</h2>
<p>First-order effects describe large-scale variations in the mean of the outcome of interest due to location or other explanatory variables, while second-order effects describe small-scale variations.</p>
</section>
<section id="global-measures-of-spatial-clustering." class="level2">
<h2 class="anchored" data-anchor-id="global-measures-of-spatial-clustering.">Global measures of Spatial Clustering.</h2>
<p>Global clustering methods are used to assess whether clustering is apparent throughout the study region but do not identify the location of clusters. The null hypothesis for global clustering methods is simply that ‘no clustering exists’ (i.e.&nbsp;random spatial dispersion) across the study region.</p>
</section>
<section id="local-measures-of-spatial-clustering." class="level2">
<h2 class="anchored" data-anchor-id="local-measures-of-spatial-clustering.">Local measures of Spatial Clustering.</h2>
<p>Global measures of spatial association assume that the spatial process under investigation is stationary. Under this assumption, which is rarely met, global tests of association run the risk of obscuring local effects. As a result, significant local clustering may not be detected and conversely, large non-clustered areas within a study area may be ignored. Local statistics overcome this problem by scanning the entire dataset, but only measuring dependence in limited portions of the study area, the bounds of which have to be specified.Local (specific) methods of cluster detection define the locations and extent of clusters. They are further divided into focused and non-focused tests.</p>
</section>
<section id="scan-circles." class="level2">
<h2 class="anchored" data-anchor-id="scan-circles.">Scan circles.</h2>
<p>Local measures of spatial clustering are divided into those primarily designed for aggregated data, and those for point data, although this distinction is not rigid and most can be used with either type of data. An important concept in understanding calculations behind local estimates of spatial clustering when point data is under consideration is the <strong>scan circles</strong>. These scan circles can be defined in terms of geographic distance (e.g.&nbsp;Openshaw’s method), number of cases (e.g.&nbsp;Besag and Newell’s method), and population size (e.g.&nbsp;Turnbull’s method and Kulldorff’s scan statistic). It is important to consider the optimal size of the scan circle while calculating local estimates of spatial clustering because a large scan circle is likely to identify spurious clusters whereas a small scan circle is likely to miss large clusters.</p>
</section>
<section id="neighbours" class="level2">
<h2 class="anchored" data-anchor-id="neighbours">Neighbours</h2>
<p>To define a neighbor, two commonly used approaches are based on adjacency and distance.</p>
<p>Other complex neighborhoods can be defined on basis of spatial relationships such as percentage of common boundaries.</p>
<section id="neighbours-defined-on-basis-of-adjacency-contiguity" class="level3">
<h3 class="anchored" data-anchor-id="neighbours-defined-on-basis-of-adjacency-contiguity">Neighbours defined on basis of adjacency/ contiguity</h3>
<p>Commonly used approaches based on adjacency to define neighbors are:-</p>
<section id="rook-contiguity" class="level4">
<h4 class="anchored" data-anchor-id="rook-contiguity">Rook contiguity</h4>
<p>Polygons are said to be neighbors or adjacent when they share a common border.</p>
</section>
<section id="queen-contiguity." class="level4">
<h4 class="anchored" data-anchor-id="queen-contiguity.">Queen contiguity.</h4>
<p>Polygons are adjacent if they share a border or corner</p>
</section>
<section id="higher-order-contiguities." class="level4">
<h4 class="anchored" data-anchor-id="higher-order-contiguities.">Higher order contiguities.</h4>
<p>Also called spatial lags.</p>
<section id="first-order-adjacency" class="level5">
<h5 class="anchored" data-anchor-id="first-order-adjacency">First-order adjacency</h5>
<p>Also called adjacent neighbors</p>
</section>
<section id="second-order-adjacency" class="level5">
<h5 class="anchored" data-anchor-id="second-order-adjacency">Second-order adjacency</h5>
<p>Also called neighbors-of-neighbors</p>
</section>
</section>
</section>
<section id="neighbours-defined-on-basis-of-distance." class="level3">
<h3 class="anchored" data-anchor-id="neighbours-defined-on-basis-of-distance.">Neighbours defined on basis of distance.</h3>
<p>In case of point data, all the events within a specified distance/ radius are said to be in neighborhood.</p>
</section>
</section>
<section id="monte-carlo-simulations." class="level2">
<h2 class="anchored" data-anchor-id="monte-carlo-simulations.">Monte Carlo simulations.</h2>
<p>Many tests for clustering use Monte Carlo simulation in order to determine the statistical significance of the cluster (i.e.&nbsp;does the observed spatial pattern differ significantly from the null hypothesis of complete spatial randomness). This involves first calculating the test statistic using the observed data, and then re-calculating it using a specified number (e.g.&nbsp;99, 499, 999) of simulated data sets (or permutations). The latter is used to generate the expected distribution of the test statistic under the null hypothesis. The likelihood of obtaining the value for the test statistic derived from the observed data is then calculated, and expressed as the p-value.</p>
</section>
<section id="measures-of-spatial-clustering-for-agggregated-data." class="level2">
<h2 class="anchored" data-anchor-id="measures-of-spatial-clustering-for-agggregated-data.">Measures of Spatial Clustering for agggregated data.</h2>
<p>Auto-correlation statistics for aggregated data provide an estimate of the degree of spatial similarity observed among neighboring values of an attribute over a study area.</p>
<p>Fundamental to all auto-correlation statistics is the <span class="math inline">\(weights\)</span> <span class="math inline">\(matrix\)</span>, used to define the spatial relationships of the regions so that those that are close in space are given greater weight in the calculation than those that are distant.</p>
</section>
<section id="global-estimates." class="level2">
<h2 class="anchored" data-anchor-id="global-estimates.">Global estimates.</h2>
<section id="morans-i." class="level3">
<h3 class="anchored" data-anchor-id="morans-i.">Moran’s I.</h3>
<section id="description." class="level4">
<h4 class="anchored" data-anchor-id="description.">Description.</h4>
<ul>
<li>Moran’s I is similar to Pearson’s correlation coefficient (r).</li>
<li>It quantifies similarity of outcome among areas that are defined as spatially related.<br>
</li>
<li>It generally lies between +1 and -1.<br>
</li>
<li>Although Moran’s I is intended for use with continuous data it can also be used to analyze count data.</li>
</ul>
</section>
<section id="interpretation." class="level4">
<h4 class="anchored" data-anchor-id="interpretation.">Interpretation.</h4>
<p>A Moran’s I of zero indicates the null hypothesis of no clustering or presence of CSR. A positive Moran’s I indicates positive spatial autocorrelation (i.e.&nbsp;clustering of areas of similar attribute values), while a negative coefficient indicates negative spatial autocorrelation (i.e.&nbsp;that neighboring areas tend to have dissimilar attribute values).</p>
</section>
<section id="tests-of-significance." class="level4">
<h4 class="anchored" data-anchor-id="tests-of-significance.">Tests of significance.</h4>
<p>Moran’s I is approximately normally distributed and the significance of Moran’s I can be assessed using Monte Carlo randomization.</p>
</section>
</section>
</section>
<section id="local-estimates." class="level2">
<h2 class="anchored" data-anchor-id="local-estimates.">Local estimates.</h2>
<section id="local-moran-test." class="level3">
<h3 class="anchored" data-anchor-id="local-moran-test.">Local Moran test.</h3>
<p>Also called as Local Indicators of Spatial Association (LISA).</p>
<p>The local Moran test detects local spatial autocorrelation in aggregated data by decomposing Moran’s I statistic into contributions for each area within a study region.</p>
<section id="moran-scatterplot" class="level4">
<h4 class="anchored" data-anchor-id="moran-scatterplot">Moran scatterplot</h4>
<ul>
<li><p>It detect clusters of either similar or dissimilar disease frequency values around a given observation.</p></li>
<li><p>The Moran’s scatter plot provides an indication of the stability of the spatial association throughout the data.</p></li>
<li><p>Horizontal axis: Observed values.</p></li>
<li><p>Vertical axis: Weighted average of neighbouring values.</p></li>
<li><p>Four types of association:- low–high, high–high, high–low and low–low.</p></li>
</ul>
</section>
</section>
</section>
<section id="illustrative-example-morans-i-and-lisa-statistics" class="level2">
<h2 class="anchored" data-anchor-id="illustrative-example-morans-i-and-lisa-statistics">Illustrative example: Moran’s I and LISA statistics</h2>
<div class="cell" data-hash="4_spatial_stats_cache/html/unnamed-chunk-2_6846c9aea4d7a616a92d833f3934a8bf">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>india_moran <span class="ot">&lt;-</span> india <span class="sc">|&gt;</span> </span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(NAME_1 <span class="sc">!=</span> <span class="st">"Andaman &amp; Nicobar Island"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(NAME_1 <span class="sc">!=</span> <span class="st">"Lakshadweep"</span>) </span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating a neighbor list from polygon list</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>neighbor_list_q <span class="ot">&lt;-</span> india_moran <span class="sc">|&gt;</span> </span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">poly2nb</span>(<span class="at">queen =</span> T)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Neighbors list object summary</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(neighbor_list_q)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Neighbour list object:
Number of regions: 34 
Number of nonzero links: 136 
Percentage nonzero weights: 11.76471 
Average number of links: 4 
Link number distribution:

1 2 3 4 5 6 7 9 
2 8 6 4 6 4 3 1 
2 least connected regions:
19 26 with 1 link
1 most connected region:
29 with 9 links</code></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Structure of neighbors list: Visualization</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(india_moran<span class="sc">$</span>geometry, </span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">border=</span><span class="st">"black"</span>); <span class="fu">plot</span>(neighbor_list_q, </span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">st_coordinates</span>(<span class="fu">st_centroid</span>(india_moran)), </span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>                           <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">cex =</span> <span class="fl">0.6</span>, <span class="at">add =</span> <span class="cn">TRUE</span>, <span class="at">col=</span> <span class="st">"red"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: st_centroid assumes attributes are constant over geometries</code></pre>
</div>
<div class="cell-output-display">
<p><img src="4_spatial_stats_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Spatial weights</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>neighbor_weights_q_w <span class="ot">&lt;-</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  neighbor_list_q <span class="sc">%&gt;%</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nb2listw</span>(<span class="at">style =</span> <span class="st">"W"</span>)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>neighbor_weights_q_w</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Characteristics of weights list object:
Neighbour list object:
Number of regions: 34 
Number of nonzero links: 136 
Percentage nonzero weights: 11.76471 
Average number of links: 4 

Weights style: W 
Weights constants summary:
   n   nn S0       S1       S2
W 34 1156 34 19.43254 151.3604</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Moran's I</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>moran_values <span class="ot">&lt;-</span> <span class="fu">moran.test</span>(india_moran<span class="sc">$</span>pop_density_india, </span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">listw =</span> neighbor_weights_q_w,</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">na.action=</span>na.omit)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>moran_values</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Moran I test under randomisation

data:  india_moran$pop_density_india  
weights: neighbor_weights_q_w    

Moran I statistic standard deviate = 2.4164, p-value = 0.007837
alternative hypothesis: greater
sample estimates:
Moran I statistic       Expectation          Variance 
      0.207391989      -0.030303030       0.009676153 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Local Moran's I</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create weights object</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>queen_w <span class="ot">&lt;-</span> <span class="fu">queen_weights</span>(india_moran)</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(queen_w)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                     name             value
1 number of observations:                34
2          is symmetric:               TRUE
3               sparsity: 0.117647058823529
4        # min neighbors:                 1
5        # max neighbors:                 9
6       # mean neighbors:                 4
7     # median neighbors:                 4
8           has isolates:             FALSE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate LISA</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>lisa <span class="ot">&lt;-</span> <span class="fu">local_moran</span>(queen_w, </span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>          india_moran[<span class="st">"pop_density_india"</span>],</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">permutations =</span> <span class="dv">999</span>,</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">significance_cutoff =</span> <span class="fl">0.1</span>,</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">seed =</span> <span class="dv">5197</span>,</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">cpu_threads =</span> <span class="dv">6</span>)</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>lisa_value <span class="ot">&lt;-</span> <span class="fu">lisa_values</span>(lisa)</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>lisa_pvalue <span class="ot">&lt;-</span> <span class="fu">lisa_pvalues</span>(lisa)</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>lisa_quad <span class="ot">&lt;-</span> <span class="fu">lisa_clusters</span>(lisa)</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>shp <span class="ot">&lt;-</span> <span class="fu">cbind</span>(india_moran, </span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>      lisa_value, </span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>      lisa_pvalue,</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>      lisa_quad)</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Create Local Moran's Map</span></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>lisa_colors <span class="ot">&lt;-</span> <span class="fu">lisa_colors</span>(lisa)</span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>lisa_labels <span class="ot">&lt;-</span> <span class="fu">lisa_labels</span>(lisa)</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>lisa_clusters <span class="ot">&lt;-</span> <span class="fu">lisa_clusters</span>(lisa)</span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>shp<span class="sc">$</span>lisa_quad <span class="ot">&lt;-</span> <span class="fu">factor</span>(lisa_quad,</span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>                       <span class="at">levels =</span>  <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>),</span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>                       <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Not significant"</span>,</span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"High-High"</span>,</span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"Low-Low"</span>,</span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"Low-High"</span>,</span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"High-Low"</span>))</span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a>lisa_map <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(shp)<span class="sc">+</span></span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="fu">aes</span>(<span class="at">fill =</span> lisa_quad))<span class="sc">+</span></span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> lisa_colors,</span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a>                    <span class="at">name =</span> <span class="st">"LISA Quadrant"</span>)<span class="sc">+</span></span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"LISA map"</span>)<span class="sc">+</span></span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a>  ggspatial<span class="sc">::</span><span class="fu">annotation_north_arrow</span>(<span class="at">height =</span> <span class="fu">unit</span>(<span class="fl">0.5</span>, <span class="st">"cm"</span>),</span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">width =</span> <span class="fu">unit</span>(<span class="fl">0.5</span>, <span class="st">"cm"</span>),</span>
<span id="cb12-34"><a href="#cb12-34" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">location =</span> <span class="st">"tl"</span>)<span class="sc">+</span></span>
<span id="cb12-35"><a href="#cb12-35" aria-hidden="true" tabindex="-1"></a>  ggspatial<span class="sc">::</span><span class="fu">annotation_scale</span>(<span class="at">height =</span> <span class="fu">unit</span>(<span class="fl">0.15</span>, <span class="st">"cm"</span>),</span>
<span id="cb12-36"><a href="#cb12-36" aria-hidden="true" tabindex="-1"></a>                              <span class="at">location =</span> <span class="st">"br"</span>)</span>
<span id="cb12-37"><a href="#cb12-37" aria-hidden="true" tabindex="-1"></a>lisa_map</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Scale on map varies by more than 10%, scale bar may be inaccurate</code></pre>
</div>
<div class="cell-output-display">
<p><img src="4_spatial_stats_files/figure-html/unnamed-chunk-2-2.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="point-pattern-analysis." class="level2">
<h2 class="anchored" data-anchor-id="point-pattern-analysis.">Point pattern analysis.</h2>
<p>There are multiple statistical tests which can be used to measure spatial clustering of point data. It is based on either the locations, distance or buffer matrix for global estimates and scan circles for local associations.</p>
</section>
<section id="measures-of-spatial-clustering-around-a-source-focused-tests." class="level2">
<h2 class="anchored" data-anchor-id="measures-of-spatial-clustering-around-a-source-focused-tests.">Measures of Spatial clustering around a source (Focused tests).</h2>
<p>Focused tests are used to establish inference regarding role of a source (eg. factory, pond, etc) in causation of disease. It is hypothesized that the disease occurrence is higher among population groups closer to the source as compared to those staying at a far away distance from the source.</p>
</section>
<section id="spatial-variation-in-risk." class="level2">
<h2 class="anchored" data-anchor-id="spatial-variation-in-risk.">Spatial variation in risk.</h2>
<p>Epidemiological disease investigations should include an assessment of the spatial variation of disease risk, as this may provide important clues leading to causal explanations. Spatial variation estimation methods broadly includes:</p>
<ol type="1">
<li><p>Smoothing methods.</p></li>
<li><p>Interpolation.</p></li>
</ol>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>