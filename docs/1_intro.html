<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Hands-on Workshop on Spatial Epidemiology using R: IPASMCON 2024 - Introduction to Spatial Epidemiology</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href=".//images/nwhda_hex.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a href="./index.html" class="navbar-brand navbar-brand-logo">
    <img src="./images/spatial_hex.png" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Hands-on Workshop on Spatial Epidemiology using R: IPASMCON 2024</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html" rel="" target="">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="./1_intro.html" rel="" target="" aria-current="page">
 <span class="menu-text">Introduction to Spatial Epidemiology</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./2_visualization.html" rel="" target="">
 <span class="menu-text">Spatial Data Visualization in Epidemiology</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./3_data_mgmt.html" rel="" target="">
 <span class="menu-text">Spatial Data Management</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./4_spatial_stats.html" rel="" target="">
 <span class="menu-text">Spatial Statistics in Epidemiology</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./5_gwr.html" rel="" target="">
 <span class="menu-text">Spatial Regression models: An introduction</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools ms-auto">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar"><div class="quarto-margin-header"><div class="margin-header-item">
<p><img src=".\images/spatial_hex.png" class="img-fluid" style="width:65.0%"></p>
</div></div>
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#section" id="toc-section" class="nav-link active" data-scroll-target="#section"></a>
  <ul class="collapse">
  <li><a href="#why-learn-spatial-epidemiology" id="toc-why-learn-spatial-epidemiology" class="nav-link" data-scroll-target="#why-learn-spatial-epidemiology">Why learn spatial epidemiology?</a></li>
  <li><a href="#brief-summary-of-the-workshop." id="toc-brief-summary-of-the-workshop." class="nav-link" data-scroll-target="#brief-summary-of-the-workshop.">Brief summary of the workshop.</a></li>
  <li><a href="#assumptions-during-the-workshop" id="toc-assumptions-during-the-workshop" class="nav-link" data-scroll-target="#assumptions-during-the-workshop">Assumptions during the workshop</a></li>
  <li><a href="#map-projections" id="toc-map-projections" class="nav-link" data-scroll-target="#map-projections">Map projections</a></li>
  <li><a href="#spatial-files-and-extensions" id="toc-spatial-files-and-extensions" class="nav-link" data-scroll-target="#spatial-files-and-extensions">Spatial Files and Extensions</a></li>
  <li><a href="#introducing-the-sf-package" id="toc-introducing-the-sf-package" class="nav-link" data-scroll-target="#introducing-the-sf-package">Introducing the <code>sf</code> package</a></li>
  <li><a href="#what-is-a-feature" id="toc-what-is-a-feature" class="nav-link" data-scroll-target="#what-is-a-feature">What is a feature?</a></li>
  <li><a href="#datasets-and-libraries-used-in-the-workshop." id="toc-datasets-and-libraries-used-in-the-workshop." class="nav-link" data-scroll-target="#datasets-and-libraries-used-in-the-workshop.">Datasets and libraries used in the workshop.</a>
  <ul class="collapse">
  <li><a href="#john-snow-datasets." id="toc-john-snow-datasets." class="nav-link" data-scroll-target="#john-snow-datasets.">John snow datasets.</a></li>
  <li><a href="#world-map." id="toc-world-map." class="nav-link" data-scroll-target="#world-map.">World map.</a></li>
  <li><a href="#india-map-with-state-boundaries." id="toc-india-map-with-state-boundaries." class="nav-link" data-scroll-target="#india-map-with-state-boundaries.">India map with state boundaries.</a></li>
  <li><a href="#covid-19-state-wise-aggregated-datasets." id="toc-covid-19-state-wise-aggregated-datasets." class="nav-link" data-scroll-target="#covid-19-state-wise-aggregated-datasets.">COVID-19 state wise aggregated datasets.</a></li>
  <li><a href="#world-population-density." id="toc-world-population-density." class="nav-link" data-scroll-target="#world-population-density.">World population density.</a></li>
  <li><a href="#new-york-leukemia-dataset" id="toc-new-york-leukemia-dataset" class="nav-link" data-scroll-target="#new-york-leukemia-dataset">New York Leukemia dataset</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Introduction to Spatial Epidemiology</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>
<p>Welcome to the world of Spatial Epidemiology!!</p>
<section id="section" class="level1">
<h1></h1>
<p>The present document is being prepared as a companion handbook to Hands-on workshop on <strong>Spatial Epidemiology using R</strong> during 51st Annual National Conference of Indian Association of Preventive and Social Medicine (IAPSMCON 2024).</p>
<section id="why-learn-spatial-epidemiology" class="level2">
<h2 class="anchored" data-anchor-id="why-learn-spatial-epidemiology">Why learn spatial epidemiology?</h2>
<p>Spatial epidemiology is the description and analysis of geographically indexed health data with respect to demographic, environmental, behavioral, socio-economic, genetic, and infectious risk factors. Spatial Epidemiology concerns the analysis of the spatial/geographical distribution of the incidence of disease. The rational of this workshop is to equip public health professionals with spatial epidemiology skills for disease analysis and risk assessment.</p>
<p>The spatial proximity and concepts in spatial epidemiology are closely related to transmission dynamics in infectious diseases. The rate of transmission is likely to be higher among individuals in close proximity as compared to those far apart. As a result, if spatial dependence is ignored, the confidence interval obtained is likely to be narrower and having higher chances of type I error (assuming positive spatial autocorrelation).</p>
<p>This chapter provides an introduction to geographic information systems (GIS) in R. The field of GIS in healthcare has become extremely useful in providing a fresh outlook to public health. GIS provides an opportunity to enable overlaying data with its spatial representation to support better planning and decision-making in healthcare. The convergence of many new sub-disciplines such as medical geography, public health, health informatics and data science help us better understand the similarities and differences in population health across the world. Some of the applications of GIS in healthcare include disease surveillance, environmental health, infectious diseases such as mathematical modelling and agent based modelling, and even medical imagining. While traditional uses of GIS in healthcare still are relevant, newer methods and advancing technology would be monumental for public health research.</p>
<p>It is now being realized that the healthcare industry can benefit tremendously from the potential of GIS. Innovative ways are being developed to harness the power of GIS through data integration pipelines and spatial visualization. Both the public and private sectors are adopting GIS to provide value addition across different sectors of healthcare - from public health departments and public health policy and research organizations to hospitals, medical centres, and health insurance organizations. With this background, let us dive right in!</p>
<p>It must be evident by now that geographic information systems (GIS) try to answer the question of WHERE:</p>
<ul>
<li>Where diseases are prevalent?</li>
<li>Where do vulnerable populations live?</li>
<li>Where are we supposed to undertake public health correction measures?</li>
<li>Where are resources most needed for improving health conditions?</li>
</ul>
<p>GIS enabled systems has the potential to offer crucial insights into such questions? However, it is also important that the right questions as being asked. In order to understand better on how to ask the right questions, we may have to revisit the history of GIS in Public Health.</p>
<p>Early examples using maps as tools to better understand disease and death have been applications such as medical mapping and disease topography. From early 17th Century, maps have not simply been used to illustrate a situation but also to prove an argument. Pioneering works in this regard have helped disprove the Theory of Miasma and identified that water as the cause of disease rather than air. Soon by the 18th Century medical maps saw many applications in public health such as plague, yellow fever, and cholera.</p>
<p>In 1854, an English physician, John Snow, provided the classic example of how GIS mapping can be used in epidemiological research. He identified the water source responsible for an outbreak of cholera in London by mapping the locations of those afflicted. By plotting the number and location of fatalities using stacks of bars on a map, Snow was able to perform a task that is now easily taken for granted: he visualized a spatial distribution. Looking at the results, the pattern on the map seems unmistakable. The map appears to support Snow’s claims that cholera is a waterborne disease and that the pump on Broad Street is the source of the outbreak. Despite its hand-drawn, back-of-the-envelope appearance, Snow writes:</p>
</section>
<section id="brief-summary-of-the-workshop." class="level2">
<h2 class="anchored" data-anchor-id="brief-summary-of-the-workshop.">Brief summary of the workshop.</h2>
<p>The overall goal of the Spatial Epidemiology workshop is to provide an introduction to spatial data analysis and workflows in R. It is aimed at building a strong foundation in Spatial Epidemiology and spatial data science for healthcare professionals.</p>
<p>The day is divided into four sessions. The first session aims to introduce the basic concepts and spatial data visualization. This will be followed by a group activity on map making. The second session will introduce the workflows and principles of working with spatial data using R through a live demo session. This will be followed by a session on the fundamentals of spatial autocorrelation analysis and group activity on spatial clustering.</p>
<p>The third session will focus on Geographic Weighted Regression (GWR). The last session will be comprising of introduction to advanced concepts including iterations and interactive visualization. This will again be followed up by a group activity and subsequently, all the groups will present their assignments before the feedback session.</p>
</section>
<section id="assumptions-during-the-workshop" class="level2">
<h2 class="anchored" data-anchor-id="assumptions-during-the-workshop">Assumptions during the workshop</h2>
<p>For the workshop, it is assumed that the data collection has been completed by the researcher and attribute data has been pre-processed for analysis. Pre-processing of datasets is of utmost importance and needs deliberation before starting with analysis of any dataset.</p>
</section>
<section id="map-projections" class="level2">
<h2 class="anchored" data-anchor-id="map-projections">Map projections</h2>
<p>Projections transform the curved, three-dimensional surface of the earth into a flat, two-dimensional plane. All map projections have distortions (distance, area, direction, and/or shape). The choice of projection depends on the intended use of the map. An equal-area map projection is a good selection for portraying geographic data distributions and is suitable for most other maps. However, if the map is attempting to show distance from patients to providers, for example, then an equidistant projection is appropriate because it preserves distance.</p>
<p>We sometimes refer to coordinate systems (or grid systems) and datums in context with map projections. With the help of coordinate reference systems (CRS) every place on the earth can be specified by a set of three numbers, called coordinates. Various coordinate systems and datums are used throughout the world. Most mapping starts with a projected map and a coordinate system overlay, which enables locational referencing. Datums, based upon different ellipsoids (idealized versions of the shape of the earth), define the origin and orientation of latitude and longitude lines. The most recently developed and widely used datum is WGS 1984. Global positioning system (GPS) data are often collected in the WGS 1984 datum.</p>
<p>It is important to note that this CRS represented in can be represented in many ways. For example:</p>
<p><code>PROJ.4</code> format as <code>+proj=longlat +datum=WGS84 +no_defs +type=crs</code>, and in Well Known Text (WKT) format as</p>
<blockquote class="blockquote">
<p>GEOGCS[“WGS 84”, DATUM[“WGS_1984”, SPHEROID[“WGS 84”,6378137,298.257223563]], PRIMEM[“Greenwich”,0], UNIT[“degree”,0.0174532925199433, AUTHORITY[“EPSG”,“9122”]], AUTHORITY[“EPSG”,“4326”]]</p>
</blockquote>
</section>
<section id="spatial-files-and-extensions" class="level2">
<h2 class="anchored" data-anchor-id="spatial-files-and-extensions">Spatial Files and Extensions</h2>
<p>There are over 60 different file formats in GIS. However, it is important to understand that the spatial data is broadly categorized into <strong>field</strong> (also known as continuous data and usually available in raster data format) and <strong>discrete</strong> (includes point, line, polygon data sets and usually available in vector data format in multitude of combinations) objects. The <em>sf</em> package is the preferred option to use vector data in R, and the <em>raster</em> and <em>terra</em> packages are the choice for raster data.</p>
<p>Vector graphics are comprised of vertices and paths. The three basic symbol types in vector data are points, lines and polygons. Among vector data, the commonly used file formats are the ESRI Shape file extensions (<code>.shp</code>, <code>.dbf</code>, <code>.shx</code>), Geographic JavaScript Object Notation (<code>.geojson</code>, <code>.json</code>) and Google Keyhole Markup Language (<code>.kml</code>, <code>.kmz</code>). Please note that all files of the ESRI Shapefiles are necessary for the file to work properly.</p>
<p>On the contrary, raster data is made up of pixels, also referred to as grid cells). They are usually square but can also be hexagons or other shapes. Rasters have pixels that are associated with a value (continuous) or class (discrete). One of the most widely used raster formats are the GeoTiff extensions (<code>.tif</code>, <code>.tiff</code>).</p>
</section>
<section id="introducing-the-sf-package" class="level2">
<h2 class="anchored" data-anchor-id="introducing-the-sf-package">Introducing the <code>sf</code> package</h2>
<p>There are several packages that are available on CRAN that can perform spatial analytical tasks and operations. However, not all of them are having continued support from the original authors and are turning obsolete.</p>
<p>The figure below shows the different spatial packages on CRAN and their popularity, its is clear that the <code>sf</code> package has surpassed all other packages in terms of popularity and user downloads.</p>
<p>The <code>sf</code> package provides simple features access for R. Simple Features is a set of standards that specify a common storage and access model of geographic feature made of mostly two-dimensional geometries (point, line, polygon, multi-point, multi-line, etc.) used by geographic information systems. It is formalized by both the Open Geospatial Consortium (OGC) and the International Organization for Standardization (ISO).</p>
</section>
<section id="what-is-a-feature" class="level2">
<h2 class="anchored" data-anchor-id="what-is-a-feature">What is a feature?</h2>
<p>A feature is thought of as a thing, or an object in the real world, such as a building or a tree. As is the case with objects, they often consist of other objects. A set of features can form a single feature. A tree in a forest can be a feature, a forest can be a feature, a city can be a feature. An image pixel from a satellite can be a feature, or a complete MRI scan image can be a feature too.</p>
<div class="cell" data-layout-align="center" data-fig.fullwidth="true" data-hash="1_intro_cache/html/unnamed-chunk-1_11708ad7eaef13b620d39908b6aecf28">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/sf_geometry_types.jpg" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption class="figure-caption">Common types of geometry in <code>sf</code> package</figcaption>
</figure>
</div>
</div>
</div>
<div style="page-break-after: always;"></div>
</section>
<section id="datasets-and-libraries-used-in-the-workshop." class="level2">
<h2 class="anchored" data-anchor-id="datasets-and-libraries-used-in-the-workshop.">Datasets and libraries used in the workshop.</h2>
<p>Lets introduce ourselves to the datasets used in this workshop before proceeding further.</p>
<div class="cell" data-hash="1_intro_cache/html/unnamed-chunk-2_2e8fa73c3d93a1e1d4b4a9ff43912e86">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse) <span class="co"># Tidy data management</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf) <span class="co"># Handling spatial and vector data</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(raster) <span class="co"># Handling raster data</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(spdep) <span class="co"># Moran's I</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rgeoda) <span class="co"># LISA statistics</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(spgwr) <span class="co"># Spatial regression packages</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(spatialreg)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="john-snow-datasets." class="level3">
<h3 class="anchored" data-anchor-id="john-snow-datasets.">John snow datasets.</h3>
<p>The Snow data consists of the relevant 1854 London streets, the location of 578 deaths from cholera, and the position of 13 water pumps (wells) that can be used to re-create John Snow’s map showing deaths from cholera in the area surrounding Broad Street, London in the 1854 outbreak.</p>
<div class="cell" data-hash="1_intro_cache/html/unnamed-chunk-3_c7e5e41bb56e6e38f38bf3e217376cad">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>snow_deaths <span class="ot">&lt;-</span> HistData<span class="sc">::</span>Snow.deaths</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>snow_deaths <span class="sc">|&gt;</span> </span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  case         x         y
1    1 13.588010 11.095600
2    2  9.878124 12.559180
3    3 14.653980 10.180440
4    4 15.220570  9.993003
5    5 13.162650 12.963190
6    6 13.806170  8.889046</code></pre>
</div>
</div>
<p>Another data frame giving coordinates used to draw the 528 street segment lines within the boundaries of the map.</p>
<div class="cell" data-hash="1_intro_cache/html/unnamed-chunk-4_d65f0158f484fbc0ee07ee6fad6f901d">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>snow_streets <span class="ot">&lt;-</span> HistData<span class="sc">::</span>Snow.streets</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>snow_streets <span class="sc">|&gt;</span> </span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  street n        x        y
1      1 2 16.73800 18.69600
2      1 2 17.66000 18.71200
3      2 2 14.46200 18.65500
4      2 2 16.73800 18.69600
5      3 2 12.79388 18.61613
6      3 2 14.46200 18.65500</code></pre>
</div>
</div>
<p>Additionally, we shall be using dataset giving the locations of water pumps within the boundaries of the map.</p>
<div class="cell" data-hash="1_intro_cache/html/unnamed-chunk-5_66a64439ee85f321adba1343d1ddf3e2">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>snow_pumps <span class="ot">&lt;-</span> HistData<span class="sc">::</span>Snow.pumps</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>snow_pumps <span class="sc">|&gt;</span> </span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  pump          label         x        y
1    1  Oxford Market  8.651201 17.89160
2    2    Castle St E 10.984780 18.51785
3    3   Oxford St #1 13.378190 17.39454
4    4   Oxford St #2 14.879830 17.80992
5    5 Gt Marlborough  8.694768 14.90547
6    6   Crown Chapel  8.864416 12.75354</code></pre>
</div>
</div>
<div style="page-break-after: always;"></div>
</section>
<section id="world-map." class="level3">
<h3 class="anchored" data-anchor-id="world-map.">World map.</h3>
<div class="cell" data-hash="1_intro_cache/html/unnamed-chunk-6_5f61130a4ffe40e0623debeed1c3a8fe">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>world <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data"</span>,</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"spatial_files"</span>, </span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"world_india_compliant.rds"</span>))</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>world <span class="sc">|&gt;</span> </span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="1_intro_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div style="page-break-after: always;"></div>
</section>
<section id="india-map-with-state-boundaries." class="level3">
<h3 class="anchored" data-anchor-id="india-map-with-state-boundaries.">India map with state boundaries.</h3>
<div class="cell" data-hash="1_intro_cache/html/unnamed-chunk-7_790189161344cb1419a49f7594cba70d">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>snow_deaths <span class="ot">&lt;-</span> HistData<span class="sc">::</span>Snow.deaths</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>snow_streets <span class="ot">&lt;-</span> HistData<span class="sc">::</span>Snow.streets</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>snow_pumps <span class="ot">&lt;-</span> HistData<span class="sc">::</span>Snow.pumps</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>world <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data"</span>,</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"spatial_files"</span>, </span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"world_india_compliant.rds"</span>))</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>india <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data"</span>,</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"spatial_files"</span>, </span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"India_states.rds"</span>))</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>india <span class="sc">|&gt;</span> </span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="1_intro_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div style="page-break-after: always;"></div>
</section>
<section id="covid-19-state-wise-aggregated-datasets." class="level3">
<h3 class="anchored" data-anchor-id="covid-19-state-wise-aggregated-datasets.">COVID-19 state wise aggregated datasets.</h3>
<p>This dataset has been downloaded from crowd-sourced COVID-19 data ans subsetted from 14 March 2020 to 31 Oct 2021 for demonstration purposes. The dataset has been further modified to calculate the cumulative number of confirmed cases for each state.</p>
<div class="cell" data-hash="1_intro_cache/html/unnamed-chunk-8_7af988223ffdbfcc0af0eaa2f06bed9e">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>covid <span class="ot">&lt;-</span> rio<span class="sc">::</span><span class="fu">import</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data"</span>,</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"covid.csv"</span>))</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Subset confirmed cases</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>covid <span class="ot">&lt;-</span> covid <span class="sc">|&gt;</span>  </span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Status <span class="sc">==</span> <span class="st">"Confirmed"</span>)</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Tidy data format</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>covid <span class="ot">&lt;-</span> covid <span class="sc">|&gt;</span> </span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="dv">4</span><span class="sc">:</span><span class="dv">42</span>,</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"state"</span>,</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"cases"</span>)</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculating cumulative cases</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>covid <span class="ot">&lt;-</span> covid <span class="sc">|&gt;</span> </span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(state) <span class="sc">|&gt;</span> </span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">cumsum =</span> <span class="fu">cumsum</span>(cases))</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Understanding data</span></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>covid <span class="sc">|&gt;</span> </span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 6
# Groups:   state [6]
  Date      Date_YMD   Status    state cases cumsum
  &lt;chr&gt;     &lt;IDate&gt;    &lt;chr&gt;     &lt;chr&gt; &lt;int&gt;  &lt;int&gt;
1 14-Mar-20 2020-03-14 Confirmed TT       81     81
2 14-Mar-20 2020-03-14 Confirmed AN        0      0
3 14-Mar-20 2020-03-14 Confirmed AP        1      1
4 14-Mar-20 2020-03-14 Confirmed AR        0      0
5 14-Mar-20 2020-03-14 Confirmed AS        0      0
6 14-Mar-20 2020-03-14 Confirmed BR        0      0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>covid <span class="sc">|&gt;</span> </span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tail</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 6
# Groups:   state [6]
  Date      Date_YMD   Status    state cases  cumsum
  &lt;chr&gt;     &lt;IDate&gt;    &lt;chr&gt;     &lt;chr&gt; &lt;int&gt;   &lt;int&gt;
1 31-Oct-21 2021-10-31 Confirmed TG      121  670953
2 31-Oct-21 2021-10-31 Confirmed TR       12   84468
3 31-Oct-21 2021-10-31 Confirmed UP        6 1710168
4 31-Oct-21 2021-10-31 Confirmed UT        5  343896
5 31-Oct-21 2021-10-31 Confirmed WB      914 1592908
6 31-Oct-21 2021-10-31 Confirmed UN        0       0</code></pre>
</div>
</div>
<div style="page-break-after: always;"></div>
</section>
<section id="world-population-density." class="level3">
<h3 class="anchored" data-anchor-id="world-population-density.">World population density.</h3>
<p>The Gridded Population of the World (GPW) collection, now in its fourth version (GPWv4), models the distribution of human population (counts and densities) on a continuous global raster surface. The purpose of GPW is to provide a spatially disaggregated population layer that is compatible with data sets from social, economic, and Earth science disciplines, and remote sensing. It provides globally consistent and spatially explicit data for use in research, policy-making, and communications.</p>
<div class="cell" data-hash="1_intro_cache/html/unnamed-chunk-9_ca90867e3a5bc3ae48f4dee3af067e64">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>pop_density <span class="ot">&lt;-</span> raster<span class="sc">::</span><span class="fu">raster</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data"</span>, </span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"spatial_files"</span>,</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"pop_density.tif"</span>))</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(pop_density)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="1_intro_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="new-york-leukemia-dataset" class="level3">
<h3 class="anchored" data-anchor-id="new-york-leukemia-dataset">New York Leukemia dataset</h3>
<p>We will use New York leukemia data from <code>spData</code> package which is a data frame with 281 observations on the following 12 variables, and the binary coded spatial weights used in the source. The variables are:- - AREANAME name of census tract<br>
- AREAKEY unique FIPS code for each tract - X x-coordinate of tract centroid (in km) - Y y-coordinate of tract centroid (in km) - POP8 population size (1980 U.S. Census) - TRACTCAS number of cases 1978-1982 - PROPCAS proportion of cases per tract - PCTOWNHOME percentage of people in each tract owning their own home - PCTAGE65P percentage of people in each tract aged 65 or more - Z transformed proportions - AVGIDIST average distance between centroid and TCE sites - PEXPOSURE “exposure potential”: inverse distance between each census tract centroid and the nearest TCE site, IDIST, transformed via log(100*IDIST)</p>
<div class="cell" data-hash="1_intro_cache/html/unnamed-chunk-10_d16bb6c01ea48498af77139c3e8b99f7">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>df_gwr <span class="ot">&lt;-</span> spData<span class="sc">::</span>nydata</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>df_gwr <span class="sc">|&gt;</span> <span class="fu">glimpse</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 281
Columns: 12
$ AREANAME   &lt;fct&gt; Binghamton city, Binghamton city, Binghamton city, Binghamt…
$ AREAKEY    &lt;fct&gt; 36007000100, 36007000200, 36007000300, 36007000400, 3600700…
$ X          &lt;dbl&gt; 4.069397, 4.639371, 5.709063, 7.613831, 7.315968, 8.558753,…
$ Y          &lt;dbl&gt; -67.3533, -66.8619, -66.9775, -65.9958, -67.3183, -66.9344,…
$ POP8       &lt;dbl&gt; 3540, 3560, 3739, 2784, 2571, 2729, 3952, 993, 1908, 948, 1…
$ TRACTCAS   &lt;dbl&gt; 3.08, 4.08, 1.09, 1.07, 3.06, 1.06, 2.09, 0.02, 2.04, 0.02,…
$ PROPCAS    &lt;dbl&gt; 0.000870, 0.001146, 0.000292, 0.000384, 0.001190, 0.000388,…
$ PCTOWNHOME &lt;dbl&gt; 0.32773109, 0.42682927, 0.33773959, 0.46160483, 0.19243697,…
$ PCTAGE65P  &lt;dbl&gt; 0.14661017, 0.23511236, 0.13800481, 0.11889368, 0.14157915,…
$ Z          &lt;dbl&gt; 0.14197, 0.35555, -0.58165, -0.29634, 0.45689, -0.28123, -0…
$ AVGIDIST   &lt;dbl&gt; 0.2373852, 0.2087413, 0.1708548, 0.1406045, 0.1577753, 0.17…
$ PEXPOSURE  &lt;dbl&gt; 3.167099, 3.038511, 2.838229, 2.643366, 2.758587, 2.848411,…</code></pre>
</div>
</div>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>