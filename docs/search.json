[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Overview",
    "section": "",
    "text": "Welcome to the world of Spatial Epidemiology!!"
  },
  {
    "objectID": "index.html#topics-covered",
    "href": "index.html#topics-covered",
    "title": "Overview",
    "section": "Topics Covered",
    "text": "Topics Covered\n\nPrinciples of Spatial Epidemiology\nSpatial Data Visualization\nSpatial Data Management\nSpatial Autocorrelation Analysis\nGeographically Weighted Regression\nAdvanced Concepts: An overview"
  },
  {
    "objectID": "index.html#resource-faculty",
    "href": "index.html#resource-faculty",
    "title": "Overview",
    "section": "Resource Faculty",
    "text": "Resource Faculty\n\nThe resource faculty for the National Workshop on Health Data Analytics are experienced professionals with expertise in spatial and spatiotemporal epidmeiology, data science, health research, and public health practice.\n\n\n\n\n\n\n \n\n\n\n\n\n\n\n\n\n\n\n\nDr. Arun Kumar Yadav\nProfessor and Commanding Officer,  Armed Forces Medical Services,  India\n\n\n\n\n\n\nBrief Bio\n\n\n\n\n\n\nDr. Arun Kumar Yadav ex Professor of Dept of Community Medicine, AFMC, Pune has guided four MD students and advised more than 1000 postgraduate/undergraduate researchers as secretary of the scientific committee and member secretary of ethics committee. He established a Multi-disciplinary unit (DHR-ICMR), GIS lab, and Health and demographic surveillance system in AFMC, Pune. He provided technical guidance for establishment of wellness center in AFMC, Pune. He is a recipient of three fellowship ( IPHA, IAPSM, AIPI) and members of 11 National and international organization. Currently he is holding the post of Joint secretary (West) in Indian public health association and academic editor of PLOS global health, earlier he was governing council member in IAPSM and executive editor of Indian Journal of Community Medicine. He has published more than 200 peer reviewed research articles in national and international journals (https://www.researchgate.net/profile/Arun-Yadav-12) and is reviewer for Nature medicine, PLOS one, MRC UK, IJPH and other reputed journals. He was assistant editor of WHO textbook of Community Medicine and public health. He is a member of national advisory board for prevention of COVID-19, implementation research and Health system reviews. He was part of team which piloted WHO tool for benchmarking Ethics oversight of Health-related research with human participants in India. He was a member of 15th common review mission for undertaking rapid assessment of functional status of national program under National health mission. He has also been regularly taking interactive session on epidemiology for National board of Examination and has conducted national workshops on systematic reviews, regression, STATA and ‘R’. Currently, he is posted in High altitude area, where he is leading projects for prevention of High-altitude illnesses. He has a special interest in evidence generation including Systematic review and meta-analysis, Hierarchical Modelling, stroke epidemiology, Health technology assessment, implementation research and ethics.\n\n\n\n\n\n\n\n\n\n\n\n\n \n\n\n\n\n\n\n\n\n\n\n\n\nProf. Biju Soman\nProfessor and Head,  Achutha Menon Centre for Health Science Studies,  SCTIMST, Trivandrum\n\n\n\n\n\n\nBrief Bio\n\n\n\n\n\n\nDr. Biju Soman is the Professor and Head of Achutha Menon Centre for Health Science Studies, Sree Chitra Tirunal Institute for Medical Sciences and Technology (SCTIMST), Trivandrum, Kerala. Dr. Soman had completed his MBBS in 1992, DPH in 1996 and M.D. (Community Medicine) in 1999 from University of Kerala and his MSc (Control of Infectious Diseases) in 2011 from University of London and DLSHTM in 2012 from the London School of Hygiene and Tropical Medicine (U.K.).\nHe has undergone advanced training in health informatics from Oslo University (Norway), Teaching Methodology from Boston School of Public Health (USA), Multilevel Modelling from Bielefeld University (Germany), and Advances in Geographic Information Systems (GIS) from National Remote Sensing Centre (Hyderabad). Dr. Soman teaches Public Health Technologies, Infectious Disease Epidemiology, and Database Management in Epidemiology modules at AMCHSS as part of the PhD and MPH curriculum. Some of his professional involvements at SCTIMST include Board of Studies (Health Sciences); Standing Academic Committee; and Research Advisory Committee. He also heads the Regional Technical Resource Centre (RTRC) of the Health Technology Assessment India (HTAIn) at SCTIMST, Trivandrum.\nHis current research and teaching are around health data science, including public health informatics, geospatial analysis, telemedicine, health technology assessment, and infectious disease epidemiology. He endorses open data initiative, FOSS resources, and reproducible research initiatives.\n\n\n\n\n\n\n\n\n\n\n\n\n \n\n\n\n\n\n\n\n\n\n\n\n\nDr. Gurpreet Singh\nAssociate Professor & Senior Medical Officer,  Armed Forces Medical Services,  India\n\n\n\n\n\n\nBrief Bio\n\n\n\n\n\n\nDr. Gurpreet Singh is a physician, Epidemiologist, and Senior Medical Officer. He completed his PhD from Achutha Menon Centre for Health Science Studies, Sree Chitra Tirunal Institute for Medical Sciences and Technology, Trivandrum. Dr Gurpreet completed his MBBS and MD (Community Medicine) from Armed Forces Medical College, Pune in 2007 and 2015 respectively, DNB (Preventive and Social Medicine) from National Board of Examinations, India in 2016. He is recipient of Director General Armed Forces Medical Services Gold Medal, President’s NBE Gold Medal, Certificate of Merit from Maharashtra University of Health Sciences, General Officer Commanding Medallion, Best PhD paper award (IPHACON 2022), and Gavin Mooney Prize (IHEPA). He has contributed chapters to a few books and has 79 scientific publications. His PhD was focused on ”Data Science approach for Spatio-temporal modelling of Dengue in Punjab, India”. He has been an active member of National and International Associations and have contributed immensely towards evacuation of students from Ukraine, relief missions in Syria, and HADR operations during Turkiye earthquake. His area of interest includes Data Science, Epidemiology, Infectious Diseases, Outbreak control and Immunization among others. He is also a firm believer of reproducible science and has conducted multiple cohorts of workshops on introduction to R and R for Spatial Epidemiology.\n\n\n\n\n\n\n\n\n\n\n\n\n \n\n\n\n\n\n\n\n\n\n\n\n\nDr. Arun Mitra Peddireddy\nResearch Scholar (DST Fellow),  SCTIMST, Trivandrum\n\n\n\n\n\n\nBrief Bio\n\n\n\n\n\n\nDr. Arun Mitra is currently pursuing his PhD in Health Data Science from Achutha Menon Centre for Health Science Studies, SCTIMST, Trivandrum. He has an MD in Community Medicine from Maharashtra University of Health Sciences and has worked as a Senior Resident at All India Institute for Medical Science (AIIMS), Bhopal before joining his PhD.\nHe received advanced training in Modern Modelling Techniques from London School of Hygiene and Tropical Medicine, UK. He is also certified in Digital Health and Imaging in Healthcare from the Indian Institute of Science (IISc), Bengaluru. He is a contributing member of the R Epidemics Consortium (https://www.repidemicsconsortium.org) based at Imperial College, London, UK. He is also a member of Society for Data Science (https://s4ds.org/) which is an international non-governmental organization working towards empowering people on data science.\nHis current work is focussed on transforming health data into evidence for public health decision making. He won many accolades at various national and international venues on his work relating to health data science. He is also recipient of the few fellowships including the prestigious DST Fellowship from the Science for Equity, Empowerment and Development (SEED) Division, Department of Science and Technology, Govt. of India."
  },
  {
    "objectID": "5_gwr.html",
    "href": "5_gwr.html",
    "title": "Spatial Regression models: An introduction",
    "section": "",
    "text": "Welcome to the world of Spatial Epidemiology!!"
  },
  {
    "objectID": "5_gwr.html#introduction",
    "href": "5_gwr.html#introduction",
    "title": "Spatial Regression models: An introduction",
    "section": "Introduction",
    "text": "Introduction\nWhen we undertake classic linear regression, one of the assumptions include that the independent variables should be independent of each other. However, in case the variables are related spatially, the assumption is voilated. It is therefore recommended that at the outset, in the exploratory phase of any study, we should look for spatial correlation. In case, it is not present, the researcher can proceed with non spatial regression models, however, if present, Geographically Weighted Regression (GWR) should be undertaken."
  },
  {
    "objectID": "5_gwr.html#what-to-do-if-spatial-dependence-is-suspected",
    "href": "5_gwr.html#what-to-do-if-spatial-dependence-is-suspected",
    "title": "Spatial Regression models: An introduction",
    "section": "What to do if spatial dependence is suspected?",
    "text": "What to do if spatial dependence is suspected?\nIf you feel like your data has spatial dependence, then the following steps should be carried out:\n\nInspect your data, construct an appropriate spatial neighborhood, and assign weights.\nRun an OLS regression with your variables of interest. This regression assumes spatial independence.\nInspect results and plot your residuals.\nCompute the Moran’s I value for the residuals.\nIf you find significant spatial correlation, do a GWR, else proceed with non spatial models."
  },
  {
    "objectID": "5_gwr.html#demonstration",
    "href": "5_gwr.html#demonstration",
    "title": "Spatial Regression models: An introduction",
    "section": "Demonstration",
    "text": "Demonstration\n\nAnalysis without considering spatial dependence\nIt is expected that the locations where the exposure is high should have higher leukemia rates. In this case, based on our previous understanding, it seems obvious, however, many times we may not be aware of underlying spatial associations and ignore the spatial aspect. Lets see what happens!!\n\ndf_gwr |&gt;  \n  ggplot()+\n  geom_point(\n    aes(x = PEXPOSURE, y = Z, color = AREANAME)\n  ) +\n  theme(legend.position = \"none\") +\n  labs(x = \"Exposure\",\n       y = \"Leukemia rate\",\n       title = \"Scatter plot: Association of Exposure and Leukemia rate\") +\n  geom_smooth(aes(x = PEXPOSURE, y = Z),\n              method = lm)\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\nSimple linear regression without spatial dynamics\n\nmodel &lt;- lm(Z ~ PEXPOSURE + PCTAGE65P + PCTOWNHOME, \n   data = df_gwr)\nsummary(model)\n\n\nCall:\nlm(formula = Z ~ PEXPOSURE + PCTAGE65P + PCTOWNHOME, data = df_gwr)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-1.7417 -0.3957 -0.0326  0.3353  4.1398 \n\nCoefficients:\n            Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept) -0.51728    0.15856  -3.262  0.00124 ** \nPEXPOSURE    0.04884    0.03506   1.393  0.16480    \nPCTAGE65P    3.95089    0.60550   6.525 3.22e-10 ***\nPCTOWNHOME  -0.56004    0.17031  -3.288  0.00114 ** \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.6571 on 277 degrees of freedom\nMultiple R-squared:  0.1932,    Adjusted R-squared:  0.1844 \nF-statistic:  22.1 on 3 and 277 DF,  p-value: 7.306e-13\n\n\nThese results suggest that PEXPOSURE is not significant, but census variables are (home ownership and percent oldies). It’s also useful to glance at R-squared estimates. It gives a sense of how well model fits the data… it tells us how much variation we’ve explained out of the total variation in the model.\n\n\nLooking at the residuals\nIn the model above, the residuals should not be spatially related. Lets have a look!\n\ndf_gwr &lt;- df_gwr |&gt; \n  mutate(residuals = model$residuals)\n\n# Transform df_gwr to sf object\ndf_gwr &lt;- st_as_sf(df_gwr,\n         coords = c(lon = \"X\",\n                    lat = \"Y\"))\n\n\n\nMoran’s I\nUsing neighbor list from polygon list and Spatial weights\n\nneighbor_weights_q_w &lt;- spData::listw_NY\ndf_gwr |&gt; \n  pull(residuals) |&gt; \n  moran.test(listw = neighbor_weights_q_w)\n\n\n    Moran I test under randomisation\n\ndata:  pull(df_gwr, residuals)  \nweights: neighbor_weights_q_w    \n\nMoran I statistic standard deviate = 2.4457, p-value = 0.007229\nalternative hypothesis: greater\nsample estimates:\nMoran I statistic       Expectation          Variance \n      0.083090278      -0.003571429       0.001255603 \n\n\n\n\nGeographically weighted regression: spatial Lag model\n\nmodel &lt;- lagsarlm(formula=Z~PEXPOSURE+PCTAGE65P+PCTOWNHOME,data=df_gwr,listw=neighbor_weights_q_w,quiet=T)\nsummary(model)\n\n\nCall:lagsarlm(formula = Z ~ PEXPOSURE + PCTAGE65P + PCTOWNHOME, data = df_gwr, \n    listw = neighbor_weights_q_w, quiet = T)\n\nResiduals:\n      Min        1Q    Median        3Q       Max \n-1.586752 -0.391580 -0.022469  0.338017  4.029430 \n\nType: lag \nCoefficients: (asymptotic standard errors) \n             Estimate Std. Error z value  Pr(&gt;|z|)\n(Intercept) -0.514495   0.156154 -3.2948  0.000985\nPEXPOSURE    0.047627   0.034509  1.3801  0.167542\nPCTAGE65P    3.648198   0.599046  6.0900 1.129e-09\nPCTOWNHOME  -0.414601   0.169554 -2.4453  0.014475\n\nRho: 0.038893, LR test value: 6.9683, p-value: 0.0082967\nAsymptotic standard error: 0.015053\n    z-value: 2.5837, p-value: 0.0097755\nWald statistic: 6.6754, p-value: 0.0097755\n\nLog likelihood: -275.2447 for lag model\nML residual variance (sigma squared): 0.41166, (sigma: 0.6416)\nNumber of observations: 281 \nNumber of parameters estimated: 6 \nAIC: 562.49, (AIC for lm: 567.46)\nLM test for residual autocorrelation\ntest value: 1.4633, p-value: 0.22641\n\n\nAs expected, spatial auto-regressive parameter \\((\\rho)\\) is highly significant (p = .008). Test for residual autocorrelation is not significant, which suggests that we cannot reject the null of randomly distributed residuals.\n\n\nMoran’s I\n\ndf_gwr |&gt; \n  pull(residuals) |&gt; \n  moran.test(listw = neighbor_weights_q_w)\n\n\n    Moran I test under randomisation\n\ndata:  pull(df_gwr, residuals)  \nweights: neighbor_weights_q_w    \n\nMoran I statistic standard deviate = 2.4457, p-value = 0.007229\nalternative hypothesis: greater\nsample estimates:\nMoran I statistic       Expectation          Variance \n      0.083090278      -0.003571429       0.001255603"
  },
  {
    "objectID": "3_data_mgmt.html",
    "href": "3_data_mgmt.html",
    "title": "Spatial Data Management",
    "section": "",
    "text": "Welcome to the world of Spatial Epidemiology!!"
  },
  {
    "objectID": "3_data_mgmt.html#introduction.",
    "href": "3_data_mgmt.html#introduction.",
    "title": "Spatial Data Management",
    "section": "Introduction.",
    "text": "Introduction.\nIt is expected that by end of the session, participants will be able to understand as well as apply varied methods for manipulation of spatial data sets."
  },
  {
    "objectID": "3_data_mgmt.html#why-importing-as-sf-object-is-recommended",
    "href": "3_data_mgmt.html#why-importing-as-sf-object-is-recommended",
    "title": "Spatial Data Management",
    "section": "Why importing as sf object is recommended?",
    "text": "Why importing as sf object is recommended?\nSimple features are open standard objects which have been endorsed by Open Geospatial Consortium. They represent heirarchial data model for 17 geometry types.\nDuring this session and in subsequent sessions on Spatial Epidemiology, we shall be using sf package. This is because sf package has inbuilt capabilities of handling 7 most common data models of simple features. Further,R spatial ecosystem is more efficient with use of sf package compared to previous packages.\nShape file format data can be imported into the R ecosystem using st_read() or read_sf() function. Both are similar in function with subtle differences. read_sf() chooses a few tidyverse defaults such as silent (st_read gives a short report), returns a spatial tibble (st_read returns a data frame), does not convert strings to factors (st_read converts to factors by default) and accepts list columns as input. For other formats st_as_sf() contains a family of conversion functions."
  },
  {
    "objectID": "3_data_mgmt.html#understanding-and-tranformation-of-coordinated-reference-system-crs.",
    "href": "3_data_mgmt.html#understanding-and-tranformation-of-coordinated-reference-system-crs.",
    "title": "Spatial Data Management",
    "section": "Understanding and Tranformation of Coordinated Reference System (CRS).",
    "text": "Understanding and Tranformation of Coordinated Reference System (CRS).\n\nKnow the CRS\nTo know the crs of a spatial dataset, use st_crs() function.\n\nindia |&gt; \n  st_crs()\n\nCoordinate Reference System:\n  User input: WGS 84 / Pseudo-Mercator \n  wkt:\nPROJCRS[\"WGS 84 / Pseudo-Mercator\",\n    BASEGEOGCRS[\"WGS 84\",\n        DATUM[\"World Geodetic System 1984\",\n            ELLIPSOID[\"WGS 84\",6378137,298.257223563,\n                LENGTHUNIT[\"metre\",1]]],\n        PRIMEM[\"Greenwich\",0,\n            ANGLEUNIT[\"degree\",0.0174532925199433]],\n        ID[\"EPSG\",4326]],\n    CONVERSION[\"Popular Visualisation Pseudo-Mercator\",\n        METHOD[\"Popular Visualisation Pseudo Mercator\",\n            ID[\"EPSG\",1024]],\n        PARAMETER[\"Latitude of natural origin\",0,\n            ANGLEUNIT[\"degree\",0.0174532925199433],\n            ID[\"EPSG\",8801]],\n        PARAMETER[\"Longitude of natural origin\",0,\n            ANGLEUNIT[\"degree\",0.0174532925199433],\n            ID[\"EPSG\",8802]],\n        PARAMETER[\"False easting\",0,\n            LENGTHUNIT[\"metre\",1],\n            ID[\"EPSG\",8806]],\n        PARAMETER[\"False northing\",0,\n            LENGTHUNIT[\"metre\",1],\n            ID[\"EPSG\",8807]]],\n    CS[Cartesian,2],\n        AXIS[\"easting (X)\",east,\n            ORDER[1],\n            LENGTHUNIT[\"metre\",1]],\n        AXIS[\"northing (Y)\",north,\n            ORDER[2],\n            LENGTHUNIT[\"metre\",1]],\n    USAGE[\n        SCOPE[\"unknown\"],\n        AREA[\"World - 85Â°S to 85Â°N\"],\n        BBOX[-85.06,-180,85.06,180]],\n    ID[\"EPSG\",3857]]\n\n\n\n\nTransforming CRS of Spatial Data\nWhen we have two or more related spatial data sets, and the CRS are different, we can transform the CRS using st_transform() function.\n\nindia &lt;- india |&gt; \n  st_transform(crs = 4326)"
  },
  {
    "objectID": "3_data_mgmt.html#manipulating-spatial-data-based-on-their-location-and-shape.",
    "href": "3_data_mgmt.html#manipulating-spatial-data-based-on-their-location-and-shape.",
    "title": "Spatial Data Management",
    "section": "Manipulating Spatial Data based on their location and shape.",
    "text": "Manipulating Spatial Data based on their location and shape.\n\nSubset Spatial data based on attributes.\nThe process of selecting only those locations which have a specified attribute is known as sub-setting and the output is subset. It is done to understand spatial distribution of a given variable and thus identify underlying patterns. Sf objects have inherent data frame class. Hence, filter() function can be used for obtaining spatial subsets.\n\nmh_subset &lt;- india |&gt; \n  filter(NAME_1 == \"Maharashtra\") \n\nmh_subset |&gt; \n  ggplot() +\n  geom_sf() +\n  labs(title = \"Subset map of Maharashtra\")\n\n\n\n\n\n\nSpatial relationships based on Topology.\nTopology is defined as spatial relationship between the objects. These include relationships such as common boundaries, intersections, one within the other, crossings, dis junctions, etc.\n\nmh_subset |&gt; \n  st_intersects(india)\n\nSparse geometry binary predicate list of length 1, where the predicate\nwas `intersects'\n 1: 7, 9, 10, 14, 16, 17, 32, 36\n\n\nSimilarly, st_within() is used to find the relationship for those strictly within boundaries, st_disjoint() is opposite of st_intersect(), st_touches() is for those objects which are touching each other (eg. polygons) and st_within_distance() for the objects within a buffer distance from the said object.\n\n\nSpatial overlay/ joins.\nPresence of a unique key is pre-requisite to joining of datasets. The same concept is utilised for overlay or joining of two or more spatial datasets with location coordinates as unique key. st_join() performs spatial joins using location coordinates as unique key. By default, left join is undertaken. in is performed.\nLets learn it through an example. We shall add a new variable to Maharashtra subset and add the same in India file using spatial overlay.\n\nmh_subset &lt;- mh_subset |&gt; \n  mutate(check_variable = \"The states sharing border with Maharashtra subset data\")\n\nindia_joined &lt;- india |&gt; \n  st_join(mh_subset)\n\nindia_joined |&gt; \n  ggplot() +\n  geom_sf(aes(fill = ifelse(\n    check_variable == \"The states sharing border with Maharashtra subset data\",\n    \"red\", \"white\"\n  ))) +\n  theme(legend.position = \"none\")\n\n\n\n\n\n\nObtaining aggregated spatial data.\nAggregation of spatial data is a process of condensing the dataset to obtain stratified summary measures. The same can be done using summarise() function.\n\nindia_joined |&gt; \n  st_drop_geometry() |&gt;\n  group_by(check_variable) |&gt; \n  summarise(mean_pop_density = mean(pop_density_india),\n            .groups = \"keep\")\n\n\n\nArea calculations.\nTo determine area of a polygon, st_area() function is used.\n\nindia |&gt; \n  st_area()  \n\nUnits: [m^2]\n [1] 164871219452 163066121108  82163787556  78559330387  94431499839\n [6]    118238781 135799676380   1504310841   3708836029 185709212363\n[11]  44081446376  55538115194  80226215548 192071260093  37853176465\n[16] 308776245994 308259630387  22368416342  22471908102  21187513837\n[21]  16631116132 156080143451    549465348  50274014378 342516183864\n[26]   7152632353 130728371017  10472109552 241157134272  53705294257\n[31]  85488226543 112699854048  52883743670   7528052264    665633067\n[36]   1050420948"
  },
  {
    "objectID": "3_data_mgmt.html#geometry-based-functions.",
    "href": "3_data_mgmt.html#geometry-based-functions.",
    "title": "Spatial Data Management",
    "section": "Geometry based functions.",
    "text": "Geometry based functions.\nWe can transform geometries with unary and binary transformations. Unary transformations are based on a single geometry in isolation and includes measures such as creation of buffers and centroids. Binary operations modify the shape of one geometry based on the other and includes measures such as clipping and geometry unions.\n\nCentroid creation.\nThe centroid based processes identify the center of a sf object and is similar to measure of central tendency. There are many variations in ways to define centre of an sf object, however, use of geographical centre remains most common. st_centroid() provides centroid values.\n\nindia_point &lt;- india |&gt; \n  st_centroid() \n\nWarning: st_centroid assumes attributes are constant over geometries\n\nindia_point\n\nSimple feature collection with 36 features and 1 field\nGeometry type: POINT\nDimension:     XY\nBounding box:  xmin: 71.5959 ymin: 10.44756 xmax: 94.66995 ymax: 34.9185\nGeodetic CRS:  WGS 84\nFirst 10 features:\n              NAME_1                  geometry\n1             Ladakh  POINT (76.78379 34.9185)\n2     Andhra Pradesh POINT (79.92681 15.73946)\n3  Arunachal Pradesh POINT (94.66995 28.04267)\n4              Assam POINT (92.82214 26.35992)\n5              Bihar  POINT (85.6038 25.68062)\n6         Chandigarh POINT (76.76828 30.73383)\n7       Chhattisgarh  POINT (82.02196 21.2504)\n10             Delhi   POINT (77.109 28.64646)\n11               Goa POINT (74.05754 15.35951)\n12           Gujarat  POINT (71.5959 22.69363)\n\n\n\n\nAdding centroids to the dataset.\n\nindia &lt;- cbind(india, \n               st_coordinates(st_centroid(india)))\n\nWarning: st_centroid assumes attributes are constant over geometries\n\nindia\n\nSimple feature collection with 36 features and 3 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 68.18625 ymin: 6.755953 xmax: 97.41516 ymax: 37.09701\nGeodetic CRS:  WGS 84\nFirst 10 features:\n              NAME_1        X        Y                       geometry\n1             Ladakh 76.78379 34.91850 MULTIPOLYGON (((76.76236 33...\n2     Andhra Pradesh 79.92681 15.73946 MULTIPOLYGON (((82.29951 16...\n3  Arunachal Pradesh 94.66995 28.04267 MULTIPOLYGON (((96.15778 29...\n4              Assam 92.82214 26.35992 MULTIPOLYGON (((89.87145 25...\n5              Bihar 85.60380 25.68062 MULTIPOLYGON (((84.11342 27...\n6         Chandigarh 76.76828 30.73383 MULTIPOLYGON (((76.77557 30...\n7       Chhattisgarh 82.02196 21.25040 MULTIPOLYGON (((83.3276 24....\n10             Delhi 77.10900 28.64646 MULTIPOLYGON (((77.08335 28...\n11               Goa 74.05754 15.35951 MULTIPOLYGON (((73.78181 15...\n12           Gujarat 71.59590 22.69363 MULTIPOLYGON (((70.86097 20...\n\n\n\n\nBuffer creation\n\nbuffer_bihar &lt;- india_point |&gt; \n  filter(NAME_1 == \"Bihar\") |&gt; \n  st_buffer(dist = 100000)\n\nggplot() +\n  geom_sf(data = india) +\n  geom_sf(data = buffer_bihar,\n          fill = \"red\",\n          alpha = 0.5)"
  },
  {
    "objectID": "3_data_mgmt.html#saving-spatial-data-and-its-output.",
    "href": "3_data_mgmt.html#saving-spatial-data-and-its-output.",
    "title": "Spatial Data Management",
    "section": "Saving Spatial Data and its output.",
    "text": "Saving Spatial Data and its output.\nThough st_write() function helps in saving spatial datasets as shapefiles, it is recommended that RDS data format be used as it uses less space in the system and is computationally faster to load subsequently."
  },
  {
    "objectID": "3_data_mgmt.html#methods-for-spatial-data-manipulation-of-raster-datasets.",
    "href": "3_data_mgmt.html#methods-for-spatial-data-manipulation-of-raster-datasets.",
    "title": "Spatial Data Management",
    "section": "Methods for spatial data manipulation of Raster datasets.",
    "text": "Methods for spatial data manipulation of Raster datasets.\n\npop_density\n\nclass      : RasterLayer \ndimensions : 180, 360, 64800  (nrow, ncol, ncell)\nresolution : 1, 1  (x, y)\nextent     : -180, 180, -90, 90  (xmin, xmax, ymin, ymax)\ncrs        : +proj=longlat +datum=WGS84 +no_defs \nsource     : pop_density.tif \nnames      : pop_density \n\n\n\nResolution\nSimilar to area calculations in a vector dataset, we would like to know about the resolution of the raster data. The res() function provides dimensions of each of the cell of the raster grid in metres (By default, UTM projection is in meters).\n\nres(pop_density)\n\n[1] 1 1\n\n\n\n\nRaster data subsets.\nTo extract value for a specified location terra::extract() function can be used.\nTo subset based on extent, the bounding box details can be extracted using st_bbox() function.\n\n\nMap algebra.\nUnderstanding of map algebra makes raster processing faster. There are four subclasses of raster based operations as under:-\n\nLocal.\nThese operations act independently for each cell of the raster.\n\n\nFocal.\nAlso known a kernel, moving window or filter operations for raster data, they choose a central cell and its neighbourhood (such as surrounding eight cells, for example). The focal operation acts similar to spatial data aggregation and results in an output of aggregated values for each combination of central cell and its neighbourhood. raster::focal() function can be used for obtaining focal values by defining the matrix for central cell and its neighbourhood.\n\n\nZonal.\nThe principle behind zonal operations is same as that of focal operations. However, unlike in focal operations, zonal operations can go beyond a rectangular matrix of neighbourhood and can provide aggregated values for a pre-defined shape or distance or area, etc. The raster::zonal() function provides zonal statistics.\n\n\nGlobal.\nThese operations are applied on the entire dataset and are used to summarise the characteristics of the given raster data such as mean, median, IQR, range etc of the datasets.\n\n\nMerging rasters.\nTwo rasters can be merged using raster::merge() function in general. However, depending upon the raster characteristics, more refined methods are available such as from packages landsat, satellite, etc. Merging rasters require same resolution and crs of the rasters as prerequisites.\n\n\n\nIllustrative raster data example: Population density raster\n\nindia &lt;- india |&gt; \n  st_transform(crs = st_crs(pop_density))\npop_density_india &lt;- exactextractr::exact_extract(pop_density,\n                             india,\n                             \"mean\",\n                             append_cols = \"NAME_1\")\n\n\n  |                                                                            \n  |                                                                      |   0%\n  |                                                                            \n  |==                                                                    |   3%\n  |                                                                            \n  |====                                                                  |   6%\n  |                                                                            \n  |======                                                                |   8%\n  |                                                                            \n  |========                                                              |  11%\n  |                                                                            \n  |==========                                                            |  14%\n  |                                                                            \n  |============                                                          |  17%\n  |                                                                            \n  |==============                                                        |  19%\n  |                                                                            \n  |================                                                      |  22%\n  |                                                                            \n  |==================                                                    |  25%\n  |                                                                            \n  |===================                                                   |  28%\n  |                                                                            \n  |=====================                                                 |  31%\n  |                                                                            \n  |=======================                                               |  33%\n  |                                                                            \n  |=========================                                             |  36%\n  |                                                                            \n  |===========================                                           |  39%\n  |                                                                            \n  |=============================                                         |  42%\n  |                                                                            \n  |===============================                                       |  44%\n  |                                                                            \n  |=================================                                     |  47%\n  |                                                                            \n  |===================================                                   |  50%\n  |                                                                            \n  |=====================================                                 |  53%\n  |                                                                            \n  |=======================================                               |  56%\n  |                                                                            \n  |=========================================                             |  58%\n  |                                                                            \n  |===========================================                           |  61%\n  |                                                                            \n  |=============================================                         |  64%\n  |                                                                            \n  |===============================================                       |  67%\n  |                                                                            \n  |=================================================                     |  69%\n  |                                                                            \n  |===================================================                   |  72%\n  |                                                                            \n  |====================================================                  |  75%\n  |                                                                            \n  |======================================================                |  78%\n  |                                                                            \n  |========================================================              |  81%\n  |                                                                            \n  |==========================================================            |  83%\n  |                                                                            \n  |============================================================          |  86%\n  |                                                                            \n  |==============================================================        |  89%\n  |                                                                            \n  |================================================================      |  92%\n  |                                                                            \n  |==================================================================    |  94%\n  |                                                                            \n  |====================================================================  |  97%\n  |                                                                            \n  |======================================================================| 100%\n\nindia &lt;- left_join(india, pop_density_india)\n\nJoining with `by = join_by(NAME_1)`\n\nindia &lt;- india |&gt; \n  rename(pop_density_india = mean)\n\n\nindia |&gt;\n  ggplot() +\n  geom_sf(aes(fill = pop_density_india)) +\n  scale_fill_gradient(low = \"green\", high = \"red\") +\n  labs(title = \"Distribution of population density in India\",\n       caption =  \"Source: SEDAC\")"
  },
  {
    "objectID": "1_intro.html",
    "href": "1_intro.html",
    "title": "Introduction to Spatial Epidemiology",
    "section": "",
    "text": "Welcome to the world of Spatial Epidemiology!!"
  },
  {
    "objectID": "1_intro.html#why-learn-spatial-epidemiology",
    "href": "1_intro.html#why-learn-spatial-epidemiology",
    "title": "Introduction to Spatial Epidemiology",
    "section": "Why learn spatial epidemiology?",
    "text": "Why learn spatial epidemiology?\nSpatial epidemiology is the description and analysis of geographically indexed health data with respect to demographic, environmental, behavioral, socio-economic, genetic, and infectious risk factors. Spatial Epidemiology concerns the analysis of the spatial/geographical distribution of the incidence of disease. The rational of this workshop is to equip public health professionals with spatial epidemiology skills for disease analysis and risk assessment.\nThe spatial proximity and concepts in spatial epidemiology are closely related to transmission dynamics in infectious diseases. The rate of transmission is likely to be higher among individuals in close proximity as compared to those far apart. As a result, if spatial dependence is ignored, the confidence interval obtained is likely to be narrower and having higher chances of type I error (assuming positive spatial autocorrelation).\nThis chapter provides an introduction to geographic information systems (GIS) in R. The field of GIS in healthcare has become extremely useful in providing a fresh outlook to public health. GIS provides an opportunity to enable overlaying data with its spatial representation to support better planning and decision-making in healthcare. The convergence of many new sub-disciplines such as medical geography, public health, health informatics and data science help us better understand the similarities and differences in population health across the world. Some of the applications of GIS in healthcare include disease surveillance, environmental health, infectious diseases such as mathematical modelling and agent based modelling, and even medical imagining. While traditional uses of GIS in healthcare still are relevant, newer methods and advancing technology would be monumental for public health research.\nIt is now being realized that the healthcare industry can benefit tremendously from the potential of GIS. Innovative ways are being developed to harness the power of GIS through data integration pipelines and spatial visualization. Both the public and private sectors are adopting GIS to provide value addition across different sectors of healthcare - from public health departments and public health policy and research organizations to hospitals, medical centres, and health insurance organizations. With this background, let us dive right in!\nIt must be evident by now that geographic information systems (GIS) try to answer the question of WHERE:\n\nWhere diseases are prevalent?\nWhere do vulnerable populations live?\nWhere are we supposed to undertake public health correction measures?\nWhere are resources most needed for improving health conditions?\n\nGIS enabled systems has the potential to offer crucial insights into such questions? However, it is also important that the right questions as being asked. In order to understand better on how to ask the right questions, we may have to revisit the history of GIS in Public Health.\nEarly examples using maps as tools to better understand disease and death have been applications such as medical mapping and disease topography. From early 17th Century, maps have not simply been used to illustrate a situation but also to prove an argument. Pioneering works in this regard have helped disprove the Theory of Miasma and identified that water as the cause of disease rather than air. Soon by the 18th Century medical maps saw many applications in public health such as plague, yellow fever, and cholera.\nIn 1854, an English physician, John Snow, provided the classic example of how GIS mapping can be used in epidemiological research. He identified the water source responsible for an outbreak of cholera in London by mapping the locations of those afflicted. By plotting the number and location of fatalities using stacks of bars on a map, Snow was able to perform a task that is now easily taken for granted: he visualized a spatial distribution. Looking at the results, the pattern on the map seems unmistakable. The map appears to support Snow’s claims that cholera is a waterborne disease and that the pump on Broad Street is the source of the outbreak. Despite its hand-drawn, back-of-the-envelope appearance, Snow writes:"
  },
  {
    "objectID": "1_intro.html#brief-summary-of-the-workshop.",
    "href": "1_intro.html#brief-summary-of-the-workshop.",
    "title": "Introduction to Spatial Epidemiology",
    "section": "Brief summary of the workshop.",
    "text": "Brief summary of the workshop.\nThe overall goal of the Spatial Epidemiology workshop is to provide an introduction to spatial data analysis and workflows in R. It is aimed at building a strong foundation in Spatial Epidemiology and spatial data science for healthcare professionals.\nThe day is divided into four sessions. The first session aims to introduce the basic concepts and spatial data visualization. This will be followed by a group activity on map making. The second session will introduce the workflows and principles of working with spatial data using R through a live demo session. This will be followed by a session on the fundamentals of spatial autocorrelation analysis and group activity on spatial clustering.\nThe third session will focus on Geographic Weighted Regression (GWR). The last session will be comprising of introduction to advanced concepts including iterations and interactive visualization. This will again be followed up by a group activity and subsequently, all the groups will present their assignments before the feedback session."
  },
  {
    "objectID": "1_intro.html#assumptions-during-the-workshop",
    "href": "1_intro.html#assumptions-during-the-workshop",
    "title": "Introduction to Spatial Epidemiology",
    "section": "Assumptions during the workshop",
    "text": "Assumptions during the workshop\nFor the workshop, it is assumed that the data collection has been completed by the researcher and attribute data has been pre-processed for analysis. Pre-processing of datasets is of utmost importance and needs deliberation before starting with analysis of any dataset."
  },
  {
    "objectID": "1_intro.html#map-projections",
    "href": "1_intro.html#map-projections",
    "title": "Introduction to Spatial Epidemiology",
    "section": "Map projections",
    "text": "Map projections\nProjections transform the curved, three-dimensional surface of the earth into a flat, two-dimensional plane. All map projections have distortions (distance, area, direction, and/or shape). The choice of projection depends on the intended use of the map. An equal-area map projection is a good selection for portraying geographic data distributions and is suitable for most other maps. However, if the map is attempting to show distance from patients to providers, for example, then an equidistant projection is appropriate because it preserves distance.\nWe sometimes refer to coordinate systems (or grid systems) and datums in context with map projections. With the help of coordinate reference systems (CRS) every place on the earth can be specified by a set of three numbers, called coordinates. Various coordinate systems and datums are used throughout the world. Most mapping starts with a projected map and a coordinate system overlay, which enables locational referencing. Datums, based upon different ellipsoids (idealized versions of the shape of the earth), define the origin and orientation of latitude and longitude lines. The most recently developed and widely used datum is WGS 1984. Global positioning system (GPS) data are often collected in the WGS 1984 datum.\nIt is important to note that this CRS represented in can be represented in many ways. For example:\nPROJ.4 format as +proj=longlat +datum=WGS84 +no_defs +type=crs, and in Well Known Text (WKT) format as\n\nGEOGCS[“WGS 84”, DATUM[“WGS_1984”, SPHEROID[“WGS 84”,6378137,298.257223563]], PRIMEM[“Greenwich”,0], UNIT[“degree”,0.0174532925199433, AUTHORITY[“EPSG”,“9122”]], AUTHORITY[“EPSG”,“4326”]]"
  },
  {
    "objectID": "1_intro.html#spatial-files-and-extensions",
    "href": "1_intro.html#spatial-files-and-extensions",
    "title": "Introduction to Spatial Epidemiology",
    "section": "Spatial Files and Extensions",
    "text": "Spatial Files and Extensions\nThere are over 60 different file formats in GIS. However, it is important to understand that the spatial data is broadly categorized into field (also known as continuous data and usually available in raster data format) and discrete (includes point, line, polygon data sets and usually available in vector data format in multitude of combinations) objects. The sf package is the preferred option to use vector data in R, and the raster and terra packages are the choice for raster data.\nVector graphics are comprised of vertices and paths. The three basic symbol types in vector data are points, lines and polygons. Among vector data, the commonly used file formats are the ESRI Shape file extensions (.shp, .dbf, .shx), Geographic JavaScript Object Notation (.geojson, .json) and Google Keyhole Markup Language (.kml, .kmz). Please note that all files of the ESRI Shapefiles are necessary for the file to work properly.\nOn the contrary, raster data is made up of pixels, also referred to as grid cells). They are usually square but can also be hexagons or other shapes. Rasters have pixels that are associated with a value (continuous) or class (discrete). One of the most widely used raster formats are the GeoTiff extensions (.tif, .tiff)."
  },
  {
    "objectID": "1_intro.html#introducing-the-sf-package",
    "href": "1_intro.html#introducing-the-sf-package",
    "title": "Introduction to Spatial Epidemiology",
    "section": "Introducing the sf package",
    "text": "Introducing the sf package\nThere are several packages that are available on CRAN that can perform spatial analytical tasks and operations. However, not all of them are having continued support from the original authors and are turning obsolete.\nThe figure below shows the different spatial packages on CRAN and their popularity, its is clear that the sf package has surpassed all other packages in terms of popularity and user downloads.\nThe sf package provides simple features access for R. Simple Features is a set of standards that specify a common storage and access model of geographic feature made of mostly two-dimensional geometries (point, line, polygon, multi-point, multi-line, etc.) used by geographic information systems. It is formalized by both the Open Geospatial Consortium (OGC) and the International Organization for Standardization (ISO)."
  },
  {
    "objectID": "1_intro.html#what-is-a-feature",
    "href": "1_intro.html#what-is-a-feature",
    "title": "Introduction to Spatial Epidemiology",
    "section": "What is a feature?",
    "text": "What is a feature?\nA feature is thought of as a thing, or an object in the real world, such as a building or a tree. As is the case with objects, they often consist of other objects. A set of features can form a single feature. A tree in a forest can be a feature, a forest can be a feature, a city can be a feature. An image pixel from a satellite can be a feature, or a complete MRI scan image can be a feature too.\n\n\n\n\n\nCommon types of geometry in sf package"
  },
  {
    "objectID": "1_intro.html#datasets-and-libraries-used-in-the-workshop.",
    "href": "1_intro.html#datasets-and-libraries-used-in-the-workshop.",
    "title": "Introduction to Spatial Epidemiology",
    "section": "Datasets and libraries used in the workshop.",
    "text": "Datasets and libraries used in the workshop.\nLets introduce ourselves to the datasets used in this workshop before proceeding further.\n\nlibrary(tidyverse) # Tidy data management\nlibrary(sf) # Handling spatial and vector data\nlibrary(raster) # Handling raster data\nlibrary(spdep) # Moran's I\nlibrary(rgeoda) # LISA statistics\nlibrary(spgwr) # Spatial regression packages\nlibrary(spatialreg)\n\n\nJohn snow datasets.\nThe Snow data consists of the relevant 1854 London streets, the location of 578 deaths from cholera, and the position of 13 water pumps (wells) that can be used to re-create John Snow’s map showing deaths from cholera in the area surrounding Broad Street, London in the 1854 outbreak.\n\nsnow_deaths &lt;- HistData::Snow.deaths\nsnow_deaths |&gt; \n  head()\n\n  case         x         y\n1    1 13.588010 11.095600\n2    2  9.878124 12.559180\n3    3 14.653980 10.180440\n4    4 15.220570  9.993003\n5    5 13.162650 12.963190\n6    6 13.806170  8.889046\n\n\nAnother data frame giving coordinates used to draw the 528 street segment lines within the boundaries of the map.\n\nsnow_streets &lt;- HistData::Snow.streets\nsnow_streets |&gt; \n  head()\n\n  street n        x        y\n1      1 2 16.73800 18.69600\n2      1 2 17.66000 18.71200\n3      2 2 14.46200 18.65500\n4      2 2 16.73800 18.69600\n5      3 2 12.79388 18.61613\n6      3 2 14.46200 18.65500\n\n\nAdditionally, we shall be using dataset giving the locations of water pumps within the boundaries of the map.\n\nsnow_pumps &lt;- HistData::Snow.pumps\nsnow_pumps |&gt; \n  head()\n\n  pump          label         x        y\n1    1  Oxford Market  8.651201 17.89160\n2    2    Castle St E 10.984780 18.51785\n3    3   Oxford St #1 13.378190 17.39454\n4    4   Oxford St #2 14.879830 17.80992\n5    5 Gt Marlborough  8.694768 14.90547\n6    6   Crown Chapel  8.864416 12.75354\n\n\n\n\n\nWorld map.\n\nworld &lt;- read_rds(here::here(\"data\",\n                            \"spatial_files\", \n                            \"world_india_compliant.rds\"))\nworld |&gt; \n  ggplot() +\n  geom_sf()\n\n\n\n\n\n\n\nIndia map with state boundaries.\n\nsnow_deaths &lt;- HistData::Snow.deaths\nsnow_streets &lt;- HistData::Snow.streets\nsnow_pumps &lt;- HistData::Snow.pumps\nworld &lt;- read_rds(here::here(\"data\",\n                            \"spatial_files\", \n                            \"world_india_compliant.rds\"))\nindia &lt;- readRDS(here::here(\"data\",\n                            \"spatial_files\", \n                            \"India_states.rds\"))\nindia |&gt; \n  ggplot() +\n  geom_sf()\n\n\n\n\n\n\n\nCOVID-19 state wise aggregated datasets.\nThis dataset has been downloaded from crowd-sourced COVID-19 data ans subsetted from 14 March 2020 to 31 Oct 2021 for demonstration purposes. The dataset has been further modified to calculate the cumulative number of confirmed cases for each state.\n\ncovid &lt;- rio::import(here::here(\"data\",\n                                \"covid.csv\"))\n# Subset confirmed cases\ncovid &lt;- covid |&gt;  \n  filter(Status == \"Confirmed\")\n# Tidy data format\ncovid &lt;- covid |&gt; \n  pivot_longer(4:42,\n               names_to = \"state\",\n               values_to = \"cases\")\n# Calculating cumulative cases\ncovid &lt;- covid |&gt; \n  group_by(state) |&gt; \n  mutate(cumsum = cumsum(cases))\n\n# Understanding data\ncovid |&gt; \n  head()\n\n# A tibble: 6 × 6\n# Groups:   state [6]\n  Date      Date_YMD   Status    state cases cumsum\n  &lt;chr&gt;     &lt;IDate&gt;    &lt;chr&gt;     &lt;chr&gt; &lt;int&gt;  &lt;int&gt;\n1 14-Mar-20 2020-03-14 Confirmed TT       81     81\n2 14-Mar-20 2020-03-14 Confirmed AN        0      0\n3 14-Mar-20 2020-03-14 Confirmed AP        1      1\n4 14-Mar-20 2020-03-14 Confirmed AR        0      0\n5 14-Mar-20 2020-03-14 Confirmed AS        0      0\n6 14-Mar-20 2020-03-14 Confirmed BR        0      0\n\ncovid |&gt; \n  tail()\n\n# A tibble: 6 × 6\n# Groups:   state [6]\n  Date      Date_YMD   Status    state cases  cumsum\n  &lt;chr&gt;     &lt;IDate&gt;    &lt;chr&gt;     &lt;chr&gt; &lt;int&gt;   &lt;int&gt;\n1 31-Oct-21 2021-10-31 Confirmed TG      121  670953\n2 31-Oct-21 2021-10-31 Confirmed TR       12   84468\n3 31-Oct-21 2021-10-31 Confirmed UP        6 1710168\n4 31-Oct-21 2021-10-31 Confirmed UT        5  343896\n5 31-Oct-21 2021-10-31 Confirmed WB      914 1592908\n6 31-Oct-21 2021-10-31 Confirmed UN        0       0\n\n\n\n\n\nWorld population density.\nThe Gridded Population of the World (GPW) collection, now in its fourth version (GPWv4), models the distribution of human population (counts and densities) on a continuous global raster surface. The purpose of GPW is to provide a spatially disaggregated population layer that is compatible with data sets from social, economic, and Earth science disciplines, and remote sensing. It provides globally consistent and spatially explicit data for use in research, policy-making, and communications.\n\npop_density &lt;- raster::raster(here::here(\"data\", \n                   \"spatial_files\",\n                   \"pop_density.tif\"))\nplot(pop_density)\n\n\n\n\n\n\nNew York Leukemia dataset\nWe will use New York leukemia data from spData package which is a data frame with 281 observations on the following 12 variables, and the binary coded spatial weights used in the source. The variables are:- - AREANAME name of census tract\n- AREAKEY unique FIPS code for each tract - X x-coordinate of tract centroid (in km) - Y y-coordinate of tract centroid (in km) - POP8 population size (1980 U.S. Census) - TRACTCAS number of cases 1978-1982 - PROPCAS proportion of cases per tract - PCTOWNHOME percentage of people in each tract owning their own home - PCTAGE65P percentage of people in each tract aged 65 or more - Z transformed proportions - AVGIDIST average distance between centroid and TCE sites - PEXPOSURE “exposure potential”: inverse distance between each census tract centroid and the nearest TCE site, IDIST, transformed via log(100*IDIST)\n\ndf_gwr &lt;- spData::nydata\n\ndf_gwr |&gt; glimpse()\n\nRows: 281\nColumns: 12\n$ AREANAME   &lt;fct&gt; Binghamton city, Binghamton city, Binghamton city, Binghamt…\n$ AREAKEY    &lt;fct&gt; 36007000100, 36007000200, 36007000300, 36007000400, 3600700…\n$ X          &lt;dbl&gt; 4.069397, 4.639371, 5.709063, 7.613831, 7.315968, 8.558753,…\n$ Y          &lt;dbl&gt; -67.3533, -66.8619, -66.9775, -65.9958, -67.3183, -66.9344,…\n$ POP8       &lt;dbl&gt; 3540, 3560, 3739, 2784, 2571, 2729, 3952, 993, 1908, 948, 1…\n$ TRACTCAS   &lt;dbl&gt; 3.08, 4.08, 1.09, 1.07, 3.06, 1.06, 2.09, 0.02, 2.04, 0.02,…\n$ PROPCAS    &lt;dbl&gt; 0.000870, 0.001146, 0.000292, 0.000384, 0.001190, 0.000388,…\n$ PCTOWNHOME &lt;dbl&gt; 0.32773109, 0.42682927, 0.33773959, 0.46160483, 0.19243697,…\n$ PCTAGE65P  &lt;dbl&gt; 0.14661017, 0.23511236, 0.13800481, 0.11889368, 0.14157915,…\n$ Z          &lt;dbl&gt; 0.14197, 0.35555, -0.58165, -0.29634, 0.45689, -0.28123, -0…\n$ AVGIDIST   &lt;dbl&gt; 0.2373852, 0.2087413, 0.1708548, 0.1406045, 0.1577753, 0.17…\n$ PEXPOSURE  &lt;dbl&gt; 3.167099, 3.038511, 2.838229, 2.643366, 2.758587, 2.848411,…"
  },
  {
    "objectID": "2_visualization.html",
    "href": "2_visualization.html",
    "title": "Spatial Data Visualization in Epidemiology",
    "section": "",
    "text": "Welcome to the world of Spatial Epidemiology!!"
  },
  {
    "objectID": "2_visualization.html#introduction.",
    "href": "2_visualization.html#introduction.",
    "title": "Spatial Data Visualization in Epidemiology",
    "section": "Introduction.",
    "text": "Introduction.\nThe role of spatial data visualization in understanding distribution and determinants of a disease were classically demonstrated in John Snow’s work in cholera epidemic of Golden Square, London in 1854 and maps have remained the most common applied aspect of Spatial epidemiology till date. Maps enable real time visualizations. However, though the concepts of spatial data visualization has its historical roots in the practice of cartography1, with the evolution of map making computational abilities, the requirement to know the cartography concepts for visualisation of spatial data for general use has decreased to minimal. For eg. we can point a location in google maps and reach a destination without deliberations on cartographic concepts (such as northing, scale, etc). This has led to \\(neogeography\\)2 and thus crowd-sourced databases due to volunteer contributions.\nIn professional and academic forums, the concepts of cartography are pre-requisites to meaningful spatial data visualization. Further, the concept of using visualization methods has evolved from just a tool for communication to the concept of visualization as an analysis tool. Visualization of spatial data is used to understand distribution patterns and generate hypothesis as well as for inferential procedures. The underlying principles in Scientific visualization has led to use of visualization methods as complementary to statistical inference procedures in spatial epidemiology. For example, the interpretation of Moran’s I3 is incomplete without accompanying visualization of dataset. The maps as analysis tools have several possible meanings and are thus polysemic in nature."
  },
  {
    "objectID": "2_visualization.html#expectations-from-the-present-session.",
    "href": "2_visualization.html#expectations-from-the-present-session.",
    "title": "Spatial Data Visualization in Epidemiology",
    "section": "Expectations from the present session.",
    "text": "Expectations from the present session.\nIt is expected that by end of this session, participants should be able to develop visualizations, understand and communicate epidemiological information, and develop hypothesis based on the visual representations of spatial data sets."
  },
  {
    "objectID": "2_visualization.html#graphic-variables.",
    "href": "2_visualization.html#graphic-variables.",
    "title": "Spatial Data Visualization in Epidemiology",
    "section": "Graphic Variables.",
    "text": "Graphic Variables.\n\\(Jacques\\) \\(Bertin\\), a french cartographer published a book \\(Semiologie\\) \\(Graphique\\), which brought forward concept of graphic variables. These variables highlight methods using which different information can be obtained from the data. The seven graphic variables as mentioned in \\(Semiology\\) \\(of\\) \\(graphics\\) (English version) are as under:-\n\nLocation.\nThe location of a spatial object varies with changing projections. It is important to understand that the transformation of CRS from geographic to projected, from raster to vector should be done with caution. The method of choice should be guided by the research objectives and need to preserve shape or location.\n\n\nValue.\nThe value of a variable is related to the darkness/ lightness of a symbol. It is usually used for variables on an interval or ratio scale. Traditionally, higher values are depicted darker.\n\n\nColor\nColor can be considered as most complex graphic variable. It represents varied sensations to different viewers. In addition, human eye is not equally sensitive across the spectrum of colors. Further, cultural affiliations, traditional representations and understandings provide challanges. A golden rule recommended is to first use color-blind friendly palettes. In the domain of Public Health, it is important to consider the color and its depiction during visualization to avoid ambiguous communication. For example: Color choice in vaccination coverage visualization as compared to color choice in obesity.\n\n\nSize.\nIn proportional symbol maps, the size of a symbol represents the difference in quantum of observations. The underlying type of data, classification adopted, transformations, and outlier management among others should be explored during visualizations.\n\n\nShape.\nSimilar to size, choice of shape of the symbol can provide clarity or increase confusion, if not considered carefully. Different shapes can be provided to distinguish different types of variables. The same can be considered to distinguish sub-types of a variable. For example, dotted lines and solid lines can be used to distinguish roads from rivers but can also be used to distinguish main roads from side-roads. Understanding of datasets and variables help in deciding correct shapes for representation of data.\n\n\nSpace.\nThe arrangement of symbols can also be used to represent differences. For example: In a dot map representing dengue occurrence data, space between the dots represent disease clustering, if any. Again, the interpretation of a variable needs careful consideration, as the case occurrence may be higher just because of underlying population figures and not otherwise.\n\n\nOrientation.\nUnderstanding the orientation of a pattern may provide critical insights into disease epidemiology. For eg. occurrence of a disease along with the course of a river may indicate risk factors associated with disease."
  },
  {
    "objectID": "2_visualization.html#map-components.",
    "href": "2_visualization.html#map-components.",
    "title": "Spatial Data Visualization in Epidemiology",
    "section": "Map components.",
    "text": "Map components.\n\nMap.\nThe vector or raster map is central to map visualizations.\n\n\nTitle.\nA short and clear title must be provided. In addition, subtitles can be added, if required.\n\n\nDistance and Scale.\nThere are two options for displaying information related to distance and scale in a map.\n1. Display of a scale bar.\n2. Use of x and y axes of the display as labeling axes.\n\n\nDirection.\nSimilar to symbolism of scale, direction can be displayed as a symbol or can be implicit in the labeled axes. Conventionally, true North is provided as a symbol in maps.\n\n\nLegend.\nNot all maps require a legend. When present, due consideration to Graphic variables should be given.\n\n\nCredits.\nThe data sources, source of geospatial files should be provided."
  },
  {
    "objectID": "2_visualization.html#understanding-the-process-of-map-creation.",
    "href": "2_visualization.html#understanding-the-process-of-map-creation.",
    "title": "Spatial Data Visualization in Epidemiology",
    "section": "Understanding the process of Map creation.",
    "text": "Understanding the process of Map creation.\nThe first step in any map making should be based on careful understanding of Co-ordinate Reference Systems. For beginners, it is recommended that all map making and spatial manipulations should be undertaken using ESPG 4326.\n\n# Setting crs to 4326\nindia &lt;- india |&gt; \n  st_transform(crs = 4326)\n\nNow, lets first create a map of India as per component of maps learned so far.\n\nCreating a Base map.\n\nindia |&gt; \n  ggplot() +\n  geom_sf()\n\n\n\nAdding Title/ sub-title.\n\nindia |&gt; ggplot()+\n  geom_sf()+\n  labs(title = \"India map\",\n       subtitle = \"Spatial Epidemiology Workshop IAPSMCON 2024\")\n\n\n\nDescribing Distance and Scale.\n\nindia |&gt; ggplot()+\n  geom_sf()+\n  labs(title = \"India map\",\n       subtitle = \"Spatial Epidemiology Workshop IAPSMCON 2024\")+\n  ggspatial::annotation_scale(location = \"bl\") #bl/ br/ tr/ tl\n\n\n\nDirection symbols.\n\nindia |&gt; ggplot()+\n  geom_sf()+\n  labs(title = \"India map\",\n       subtitle = \"Spatial Epidemiology Workshop IAPSMCON 2024\")+\n  ggspatial::annotation_scale(location = \"bl\")+\n  ggspatial::annotation_north_arrow(location = \"br\")\n\n\n\nAdding axis labels\n\nindia |&gt; ggplot()+\n  geom_sf()+\n  labs(title = \"India map\",\n       subtitle = \"Spatial Epidemiology Workshop IAPSMCON 2024\")+\n  ggspatial::annotation_scale(location = \"bl\")+\n  ggspatial::annotation_north_arrow(location = \"tr\")+\n  xlab(\"Longitude\")+\n  ylab(\"Latitude\")\n\n\n\nAcknowledging Credits.\n\nindia |&gt; ggplot()+\n  geom_sf()+\n  labs(title = \"India map\",\n       subtitle = \"Spatial Epidemiology Workshop\")+\n  ggspatial::annotation_scale(location = \"bl\")+\n  ggspatial::annotation_north_arrow(location = \"tr\")+\n  xlab(\"Longitude\")+\n  ylab(\"Latitude\")+\n  geom_text(aes(x = 87.5, \n                y = 10.3, \n                label = \"Credits: IAPSMCON 2024\"),\n            color = \"black\", \n            check_overlap = T, \n            size = 3)\n\nScale on map varies by more than 10%, scale bar may be inaccurate\n\n\n\n\n\n\n\nAdding labels and legends.\nAddition of labels and legends is optional in map making. The following code can be used to add labels to the map\n\n#adding abbreviations\nindia$abbr &lt;- c(\"LA\",\"AP\",\"AR\", \"AS\",\"BR\", \"CH\",\"CT\", \"DL\",\n              \"GA\", \"GJ\",\"HR\", \"HP\",\"JH\", \"KA\",\"KL\", \"MP\",\n              \"MH\",\"MN\",\"ML\", \"MZ\",\"NL\", \"OR\",\"PY\", \"PB\",\n              \"RJ\", \"SK\",\"TN\", \"TR\",\"UP\", \"UT\",\"WB\", \"TG\",\n              \"JK\", \"LD\",\"AN\", \"DDDN\")\n\n\n## labeling abbreviations\nindia |&gt; ggplot()+\n  geom_sf()+\n  labs(title = \"India map\",\n       subtitle = \"Spatial Epidemiology Workshop IAPSMCON 2024\")+\n  ggspatial::annotation_scale(location = \"bl\")+\n  ggspatial::annotation_north_arrow(location = \"tr\")+\n  xlab(\"Longitude\")+\n  ylab(\"Latitude\")+\n  geom_text(aes(x = 87.5, y = 10.3, label = \"Credits: IAPSMCON 2024\"),\n             color = \"black\", check_overlap = T, size = 2)+\n  geom_sf_label(aes(label = abbr))"
  },
  {
    "objectID": "2_visualization.html#visualisation-of-point-data.",
    "href": "2_visualization.html#visualisation-of-point-data.",
    "title": "Spatial Data Visualization in Epidemiology",
    "section": "Visualisation of point data.",
    "text": "Visualisation of point data.\nKindly note: For the purpose of clarity on a particular aspect of the map, we will avoid placing all components of a map across the session. This is important to understand that when communicating maps/ figures, all components should be present.\n\nDot Maps.\nThe simplest method to visualize disease occurrence patterns is creation of dot maps. They help us understand spatial dependencies in disease occurrence. The spatial clustering of a disease is suggestive of factors present/ absent in locations with high disease occurrence as compared to locations with low disease occurrence. Thus, point maps provides visual tool for providing estimates of Spatial Clustering. Important limitation of these dot maps is the inability to visualize independent events as the number of observations increase or multiple events are observed at the same location. To overcome the same methods such as smoothing, rasterisation and dot density maps is recommended.\n\n\nIllustrative Example: John Snow maps\nLet us create a dot map of John Snow data. To do the same, we need to convert data.frame into an sf object using the st_as_af() function.\n\nsnow_deaths_sf &lt;- snow_deaths |&gt; \n  st_as_sf(coords = c('x', 'y'), \n           crs = 4326)\n\nsnow_deaths_sf |&gt; \n  ggplot() +\n  geom_sf() \n\n\n\n\nNow, we can add additional layers such as the water pumps and the streets of Soho, London.\n\nsnow_streets_sf &lt;- snow_streets |&gt; \n  st_as_sf(coords = c('x', 'y'), crs = 4326) |&gt; \n  group_by(street) |&gt; \n  summarize(n = mean(n)) |&gt;  \n  st_cast('LINESTRING')\n\nsnow_streets_sf |&gt; \n  ggplot() +\n  geom_sf() \n\n\n\n\nLet us add the streets of Soho, London as a new layer in our previously created deaths map.\n\nggplot() +\n  geom_sf(data = snow_streets_sf) +\n  geom_sf(data = snow_deaths_sf, \n          color = 'red', \n          alpha = 0.5, \n          size = 1)\n\n\n\n\nWe can now add a new layer of water pumps on the above map.\n\nsnow_pumps_sf &lt;- snow_pumps |&gt; \n  st_as_sf(coords = c('x', 'y'), \n           crs = 4326)\n\nggplot() +\n  geom_sf(data = snow_streets_sf) +\n  geom_sf(data = snow_deaths_sf, color = 'red', alpha = 0.2, size = 3) +\n  geom_sf(data = snow_pumps_sf , shape = 22, size = 1, fill = 'blue', color = 'blue') +\n  geom_sf_label(data = snow_pumps_sf, \n                aes(label = label), \n                nudge_x = 0.025, \n                nudge_y = -0.5)\n\nWarning in st_point_on_surface.sfc(sf::st_zm(x)): st_point_on_surface may not\ngive correct results for longitude/latitude data"
  },
  {
    "objectID": "2_visualization.html#visualisation-of-aggregate-data.",
    "href": "2_visualization.html#visualisation-of-aggregate-data.",
    "title": "Spatial Data Visualization in Epidemiology",
    "section": "Visualisation of aggregate data.",
    "text": "Visualisation of aggregate data.\n\nChoropleth Maps.\nThe term “choropleth” is derived from Greek words \\(Khoros\\) meaning “place” and \\(plethein\\) meaning “full”. In choropleth maps, aggregated value for a given area forms the basis of visual representation. The three major challenges in interpretation of choropleth maps arise from large area polygons, Modified Unit Area Problem, and presence of skewed data. Deliberation on these issues, creation of cartograms, data transformation methods such Box-Cox transformations and multi-level analysis are recommended to overcome these limitations.\n\nExample: COVID 19 cases\nLets summarise state wise total covid 19 cases and merge it with india map to plot a choropleth map as demonstration.\n\ndf &lt;- covid |&gt; \n  group_by(state) |&gt; \n  summarise(cases = sum(cases))\n\nindia &lt;- left_join(india, df,\n          by = c(\"abbr\" = \"state\")) \n\nindia |&gt; \n  ggplot()+\n  geom_sf(aes(fill = cases)) +\n  scale_fill_gradient(low = \"white\", high = \"red\") +\n  labs(fill = \"COVID-19 cases\",\n       caption = \"For demonstration only\",\n       title = \"India COVID-19 cases (Subset data)\",\n       subtitle = \"For demonstration only\")\n\n\n\n\nThink!! Why such maps are not good visualizations?"
  },
  {
    "objectID": "2_visualization.html#visualization-using-web-based-maps.",
    "href": "2_visualization.html#visualization-using-web-based-maps.",
    "title": "Spatial Data Visualization in Epidemiology",
    "section": "Visualization using Web based maps.",
    "text": "Visualization using Web based maps.\nMany a times it becomes difficult to get a shape file of the stud area. Various sources of shape files is available online (eg. DataMeet, SEDAC, HGL, DIVA-GIS, Bhuvan, Survey of India, etc.). Leaflet package helps us to use web maps from open sources such as Open Street Map, ESRI maps, cartoDB, etc."
  },
  {
    "objectID": "2_visualization.html#footnotes",
    "href": "2_visualization.html#footnotes",
    "title": "Spatial Data Visualization in Epidemiology",
    "section": "Footnotes",
    "text": "Footnotes\n\n\nThe science and art of making maps↩︎\nThe process of map creation as primary objective but owing little to past cartographic traditions.↩︎\nMeasure of spatial clustering. Details covered in “Measures of Spatial Clustering” session↩︎"
  },
  {
    "objectID": "4_spatial_stats.html",
    "href": "4_spatial_stats.html",
    "title": "Spatial Statistics in Epidemiology",
    "section": "",
    "text": "Welcome to the world of Spatial Epidemiology!!\nThe descriptive measures in routine data analysis includes measures of central tendency (e.g. mean, median, mode) and measures of dispersion such as (e.g. SD, range, IQR). The choice of the descriptive measure chosen to describe the study variable depends upon the type of data and on the scale of measurement. While describing spatial datasets, these known measures of describing a study variable are complemented with additional summary measures to describe spatial data.\n|                                                                            \n  |                                                                      |   0%\n  |                                                                            \n  |==                                                                    |   3%\n  |                                                                            \n  |====                                                                  |   6%\n  |                                                                            \n  |======                                                                |   8%\n  |                                                                            \n  |========                                                              |  11%\n  |                                                                            \n  |==========                                                            |  14%\n  |                                                                            \n  |============                                                          |  17%\n  |                                                                            \n  |==============                                                        |  19%\n  |                                                                            \n  |================                                                      |  22%\n  |                                                                            \n  |==================                                                    |  25%\n  |                                                                            \n  |===================                                                   |  28%\n  |                                                                            \n  |=====================                                                 |  31%\n  |                                                                            \n  |=======================                                               |  33%\n  |                                                                            \n  |=========================                                             |  36%\n  |                                                                            \n  |===========================                                           |  39%\n  |                                                                            \n  |=============================                                         |  42%\n  |                                                                            \n  |===============================                                       |  44%\n  |                                                                            \n  |=================================                                     |  47%\n  |                                                                            \n  |===================================                                   |  50%\n  |                                                                            \n  |=====================================                                 |  53%\n  |                                                                            \n  |=======================================                               |  56%\n  |                                                                            \n  |=========================================                             |  58%\n  |                                                                            \n  |===========================================                           |  61%\n  |                                                                            \n  |=============================================                         |  64%\n  |                                                                            \n  |===============================================                       |  67%\n  |                                                                            \n  |=================================================                     |  69%\n  |                                                                            \n  |===================================================                   |  72%\n  |                                                                            \n  |====================================================                  |  75%\n  |                                                                            \n  |======================================================                |  78%\n  |                                                                            \n  |========================================================              |  81%\n  |                                                                            \n  |==========================================================            |  83%\n  |                                                                            \n  |============================================================          |  86%\n  |                                                                            \n  |==============================================================        |  89%\n  |                                                                            \n  |================================================================      |  92%\n  |                                                                            \n  |==================================================================    |  94%\n  |                                                                            \n  |====================================================================  |  97%\n  |                                                                            \n  |======================================================================| 100%"
  },
  {
    "objectID": "4_spatial_stats.html#expectations-from-the-present-session.",
    "href": "4_spatial_stats.html#expectations-from-the-present-session.",
    "title": "Spatial Statistics in Epidemiology",
    "section": "Expectations from the present session.",
    "text": "Expectations from the present session.\nBy the end of the session, students should be able to understand methods which are used to describe spatial distribution of study variable. The students are also expected to understand the difference in concept as well as methods in describing global estimates as compared to local estimates for presence of spatial clustering, if any."
  },
  {
    "objectID": "4_spatial_stats.html#complete-spatial-randomness-csr.",
    "href": "4_spatial_stats.html#complete-spatial-randomness-csr.",
    "title": "Spatial Statistics in Epidemiology",
    "section": "Complete Spatial Randomness (CSR).",
    "text": "Complete Spatial Randomness (CSR).\nIt is also known as “Random Spatial Distribution” or “Independent Spatial Distribution”. When there is no spatial dependence, an event is expected to have CSR. Lack of CSR indicates spatial clustering."
  },
  {
    "objectID": "4_spatial_stats.html#stationarity.",
    "href": "4_spatial_stats.html#stationarity.",
    "title": "Spatial Statistics in Epidemiology",
    "section": "Stationarity.",
    "text": "Stationarity.\nA spatial process is said to be stationary when the dependence between measurements of the same variable across space is the same for all locations in an area. When the event occurrence is in CSR or in a regular pattern, the underlying process is said to be stationary."
  },
  {
    "objectID": "4_spatial_stats.html#isotropy.",
    "href": "4_spatial_stats.html#isotropy.",
    "title": "Spatial Statistics in Epidemiology",
    "section": "Isotropy.",
    "text": "Isotropy.\nIf the dependence in a stationary process is affected by distance, but this is the same in all directions, the process is considered to be isotropic. When the stationary process is affected by distance and is not same in all directions, the process is considered to be anisotropic."
  },
  {
    "objectID": "4_spatial_stats.html#spatial-cluster.",
    "href": "4_spatial_stats.html#spatial-cluster.",
    "title": "Spatial Statistics in Epidemiology",
    "section": "Spatial Cluster.",
    "text": "Spatial Cluster.\nKnox defined a cluster as “a geographically and/or temporally bounded group of occurrences of sufficient size and concentration to be unlikely to have occurred by chance”."
  },
  {
    "objectID": "4_spatial_stats.html#first-and-second-order-effects.",
    "href": "4_spatial_stats.html#first-and-second-order-effects.",
    "title": "Spatial Statistics in Epidemiology",
    "section": "First and second order effects.",
    "text": "First and second order effects.\nFirst-order effects describe large-scale variations in the mean of the outcome of interest due to location or other explanatory variables, while second-order effects describe small-scale variations."
  },
  {
    "objectID": "4_spatial_stats.html#global-measures-of-spatial-clustering.",
    "href": "4_spatial_stats.html#global-measures-of-spatial-clustering.",
    "title": "Spatial Statistics in Epidemiology",
    "section": "Global measures of Spatial Clustering.",
    "text": "Global measures of Spatial Clustering.\nGlobal clustering methods are used to assess whether clustering is apparent throughout the study region but do not identify the location of clusters. The null hypothesis for global clustering methods is simply that ‘no clustering exists’ (i.e. random spatial dispersion) across the study region."
  },
  {
    "objectID": "4_spatial_stats.html#local-measures-of-spatial-clustering.",
    "href": "4_spatial_stats.html#local-measures-of-spatial-clustering.",
    "title": "Spatial Statistics in Epidemiology",
    "section": "Local measures of Spatial Clustering.",
    "text": "Local measures of Spatial Clustering.\nGlobal measures of spatial association assume that the spatial process under investigation is stationary. Under this assumption, which is rarely met, global tests of association run the risk of obscuring local effects. As a result, significant local clustering may not be detected and conversely, large non-clustered areas within a study area may be ignored. Local statistics overcome this problem by scanning the entire dataset, but only measuring dependence in limited portions of the study area, the bounds of which have to be specified.Local (specific) methods of cluster detection define the locations and extent of clusters. They are further divided into focused and non-focused tests."
  },
  {
    "objectID": "4_spatial_stats.html#scan-circles.",
    "href": "4_spatial_stats.html#scan-circles.",
    "title": "Spatial Statistics in Epidemiology",
    "section": "Scan circles.",
    "text": "Scan circles.\nLocal measures of spatial clustering are divided into those primarily designed for aggregated data, and those for point data, although this distinction is not rigid and most can be used with either type of data. An important concept in understanding calculations behind local estimates of spatial clustering when point data is under consideration is the scan circles. These scan circles can be defined in terms of geographic distance (e.g. Openshaw’s method), number of cases (e.g. Besag and Newell’s method), and population size (e.g. Turnbull’s method and Kulldorff’s scan statistic). It is important to consider the optimal size of the scan circle while calculating local estimates of spatial clustering because a large scan circle is likely to identify spurious clusters whereas a small scan circle is likely to miss large clusters."
  },
  {
    "objectID": "4_spatial_stats.html#neighbours",
    "href": "4_spatial_stats.html#neighbours",
    "title": "Spatial Statistics in Epidemiology",
    "section": "Neighbours",
    "text": "Neighbours\nTo define a neighbor, two commonly used approaches are based on adjacency and distance.\nOther complex neighborhoods can be defined on basis of spatial relationships such as percentage of common boundaries.\n\nNeighbours defined on basis of adjacency/ contiguity\nCommonly used approaches based on adjacency to define neighbors are:-\n\nRook contiguity\nPolygons are said to be neighbors or adjacent when they share a common border.\n\n\nQueen contiguity.\nPolygons are adjacent if they share a border or corner\n\n\nHigher order contiguities.\nAlso called spatial lags.\n\nFirst-order adjacency\nAlso called adjacent neighbors\n\n\nSecond-order adjacency\nAlso called neighbors-of-neighbors\n\n\n\n\nNeighbours defined on basis of distance.\nIn case of point data, all the events within a specified distance/ radius are said to be in neighborhood."
  },
  {
    "objectID": "4_spatial_stats.html#monte-carlo-simulations.",
    "href": "4_spatial_stats.html#monte-carlo-simulations.",
    "title": "Spatial Statistics in Epidemiology",
    "section": "Monte Carlo simulations.",
    "text": "Monte Carlo simulations.\nMany tests for clustering use Monte Carlo simulation in order to determine the statistical significance of the cluster (i.e. does the observed spatial pattern differ significantly from the null hypothesis of complete spatial randomness). This involves first calculating the test statistic using the observed data, and then re-calculating it using a specified number (e.g. 99, 499, 999) of simulated data sets (or permutations). The latter is used to generate the expected distribution of the test statistic under the null hypothesis. The likelihood of obtaining the value for the test statistic derived from the observed data is then calculated, and expressed as the p-value."
  },
  {
    "objectID": "4_spatial_stats.html#measures-of-spatial-clustering-for-agggregated-data.",
    "href": "4_spatial_stats.html#measures-of-spatial-clustering-for-agggregated-data.",
    "title": "Spatial Statistics in Epidemiology",
    "section": "Measures of Spatial Clustering for agggregated data.",
    "text": "Measures of Spatial Clustering for agggregated data.\nAuto-correlation statistics for aggregated data provide an estimate of the degree of spatial similarity observed among neighboring values of an attribute over a study area.\nFundamental to all auto-correlation statistics is the \\(weights\\) \\(matrix\\), used to define the spatial relationships of the regions so that those that are close in space are given greater weight in the calculation than those that are distant."
  },
  {
    "objectID": "4_spatial_stats.html#global-estimates.",
    "href": "4_spatial_stats.html#global-estimates.",
    "title": "Spatial Statistics in Epidemiology",
    "section": "Global estimates.",
    "text": "Global estimates.\n\nMoran’s I.\n\nDescription.\n\nMoran’s I is similar to Pearson’s correlation coefficient (r).\nIt quantifies similarity of outcome among areas that are defined as spatially related.\n\nIt generally lies between +1 and -1.\n\nAlthough Moran’s I is intended for use with continuous data it can also be used to analyze count data.\n\n\n\nInterpretation.\nA Moran’s I of zero indicates the null hypothesis of no clustering or presence of CSR. A positive Moran’s I indicates positive spatial autocorrelation (i.e. clustering of areas of similar attribute values), while a negative coefficient indicates negative spatial autocorrelation (i.e. that neighboring areas tend to have dissimilar attribute values).\n\n\nTests of significance.\nMoran’s I is approximately normally distributed and the significance of Moran’s I can be assessed using Monte Carlo randomization."
  },
  {
    "objectID": "4_spatial_stats.html#local-estimates.",
    "href": "4_spatial_stats.html#local-estimates.",
    "title": "Spatial Statistics in Epidemiology",
    "section": "Local estimates.",
    "text": "Local estimates.\n\nLocal Moran test.\nAlso called as Local Indicators of Spatial Association (LISA).\nThe local Moran test detects local spatial autocorrelation in aggregated data by decomposing Moran’s I statistic into contributions for each area within a study region.\n\nMoran scatterplot\n\nIt detect clusters of either similar or dissimilar disease frequency values around a given observation.\nThe Moran’s scatter plot provides an indication of the stability of the spatial association throughout the data.\nHorizontal axis: Observed values.\nVertical axis: Weighted average of neighbouring values.\nFour types of association:- low–high, high–high, high–low and low–low."
  },
  {
    "objectID": "4_spatial_stats.html#illustrative-example-morans-i-and-lisa-statistics",
    "href": "4_spatial_stats.html#illustrative-example-morans-i-and-lisa-statistics",
    "title": "Spatial Statistics in Epidemiology",
    "section": "Illustrative example: Moran’s I and LISA statistics",
    "text": "Illustrative example: Moran’s I and LISA statistics\n\nindia_moran &lt;- india |&gt; \n  filter(NAME_1 != \"Andaman & Nicobar Island\") |&gt; \n  filter(NAME_1 != \"Lakshadweep\") \n\n# Creating a neighbor list from polygon list\nneighbor_list_q &lt;- india_moran |&gt; \n  poly2nb(queen = T)\n# Neighbors list object summary\nsummary(neighbor_list_q)\n\nNeighbour list object:\nNumber of regions: 34 \nNumber of nonzero links: 136 \nPercentage nonzero weights: 11.76471 \nAverage number of links: 4 \nLink number distribution:\n\n1 2 3 4 5 6 7 9 \n2 8 6 4 6 4 3 1 \n2 least connected regions:\n19 26 with 1 link\n1 most connected region:\n29 with 9 links\n\n# Structure of neighbors list: Visualization\nplot(india_moran$geometry, \n     border=\"black\"); plot(neighbor_list_q, \n                           st_coordinates(st_centroid(india_moran)), \n                           pch = 19, cex = 0.6, add = TRUE, col= \"red\")\n\nWarning: st_centroid assumes attributes are constant over geometries\n\n\n\n\n# Spatial weights\nneighbor_weights_q_w &lt;-\n  neighbor_list_q %&gt;%\n  nb2listw(style = \"W\")\n\nneighbor_weights_q_w\n\nCharacteristics of weights list object:\nNeighbour list object:\nNumber of regions: 34 \nNumber of nonzero links: 136 \nPercentage nonzero weights: 11.76471 \nAverage number of links: 4 \n\nWeights style: W \nWeights constants summary:\n   n   nn S0       S1       S2\nW 34 1156 34 19.43254 151.3604\n\n# Moran's I\nmoran_values &lt;- moran.test(india_moran$pop_density_india, \n           listw = neighbor_weights_q_w,\n           na.action=na.omit)\n\nmoran_values\n\n\n    Moran I test under randomisation\n\ndata:  india_moran$pop_density_india  \nweights: neighbor_weights_q_w    \n\nMoran I statistic standard deviate = 2.4164, p-value = 0.007837\nalternative hypothesis: greater\nsample estimates:\nMoran I statistic       Expectation          Variance \n      0.207391989      -0.030303030       0.009676153 \n\n# Local Moran's I\n\n\n# Create weights object\nqueen_w &lt;- queen_weights(india_moran)\nsummary(queen_w)\n\n                     name             value\n1 number of observations:                34\n2          is symmetric:               TRUE\n3               sparsity: 0.117647058823529\n4        # min neighbors:                 1\n5        # max neighbors:                 9\n6       # mean neighbors:                 4\n7     # median neighbors:                 4\n8           has isolates:             FALSE\n\n# Calculate LISA\nlisa &lt;- local_moran(queen_w, \n          india_moran[\"pop_density_india\"],\n          permutations = 999,\n          significance_cutoff = 0.1,\n          seed = 5197,\n          cpu_threads = 6)\nlisa_value &lt;- lisa_values(lisa)\nlisa_pvalue &lt;- lisa_pvalues(lisa)\nlisa_quad &lt;- lisa_clusters(lisa)\nshp &lt;- cbind(india_moran, \n      lisa_value, \n      lisa_pvalue,\n      lisa_quad)\n# Create Local Moran's Map\nlisa_colors &lt;- lisa_colors(lisa)\nlisa_labels &lt;- lisa_labels(lisa)\nlisa_clusters &lt;- lisa_clusters(lisa)\n\nshp$lisa_quad &lt;- factor(lisa_quad,\n                       levels =  c(0,1,2,3,4),\n                       labels = c(\"Not significant\",\n                                  \"High-High\",\n                                  \"Low-Low\",\n                                  \"Low-High\",\n                                  \"High-Low\"))\nlisa_map &lt;- ggplot(shp)+\n  geom_sf(aes(fill = lisa_quad))+\n  scale_fill_manual(values = lisa_colors,\n                    name = \"LISA Quadrant\")+\n  labs(title = \"LISA map\")+\n  ggspatial::annotation_north_arrow(height = unit(0.5, \"cm\"),\n                                    width = unit(0.5, \"cm\"),\n                                    location = \"tl\")+\n  ggspatial::annotation_scale(height = unit(0.15, \"cm\"),\n                              location = \"br\")\nlisa_map\n\nScale on map varies by more than 10%, scale bar may be inaccurate"
  },
  {
    "objectID": "4_spatial_stats.html#point-pattern-analysis.",
    "href": "4_spatial_stats.html#point-pattern-analysis.",
    "title": "Spatial Statistics in Epidemiology",
    "section": "Point pattern analysis.",
    "text": "Point pattern analysis.\nThere are multiple statistical tests which can be used to measure spatial clustering of point data. It is based on either the locations, distance or buffer matrix for global estimates and scan circles for local associations."
  },
  {
    "objectID": "4_spatial_stats.html#measures-of-spatial-clustering-around-a-source-focused-tests.",
    "href": "4_spatial_stats.html#measures-of-spatial-clustering-around-a-source-focused-tests.",
    "title": "Spatial Statistics in Epidemiology",
    "section": "Measures of Spatial clustering around a source (Focused tests).",
    "text": "Measures of Spatial clustering around a source (Focused tests).\nFocused tests are used to establish inference regarding role of a source (eg. factory, pond, etc) in causation of disease. It is hypothesized that the disease occurrence is higher among population groups closer to the source as compared to those staying at a far away distance from the source."
  },
  {
    "objectID": "4_spatial_stats.html#spatial-variation-in-risk.",
    "href": "4_spatial_stats.html#spatial-variation-in-risk.",
    "title": "Spatial Statistics in Epidemiology",
    "section": "Spatial variation in risk.",
    "text": "Spatial variation in risk.\nEpidemiological disease investigations should include an assessment of the spatial variation of disease risk, as this may provide important clues leading to causal explanations. Spatial variation estimation methods broadly includes:\n\nSmoothing methods.\nInterpolation."
  },
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About",
    "section": "",
    "text": "Welcome to the world of Spatial Epidemiology!!\n::: justify # About the Resource Team\nOur team is comprised of skilled professionals who possess a wealth of experience in the field of Spatial Epidemiology and health data science. Together, we are committed to converting spatial health data into meaningful evidence for public health decision-making purposes.\nOur team’s areas of expertise include public health informatics, geospatial analysis, telemedicine, health technology assessment, and infectious disease epidemiology. In addition to that, we promote open data initiatives, FOSS resources, and reproducible research initiatives to facilitate people’s understanding of data science. Our team members are also affiliated with the R Epidemics Consortium and the Society for Data Science, international organizations dedicated to enhancing people’s data science skills.\nMembers of our have undergone advanced training and have participated in several funded data science initiatives and projects. We are passionate about social determinants of health, health policy, implementation studies, health systems research, and health inequity. We are devoted to offering guidance and support to participants in the IAPSMCON 2024 Pre conference Hands on workshop on Spatial Epidemiology using R, empowering them to develop the skills and knowledge required to excel in health data analytics with focus on Geospatial analysis.\n\nSome Spatial Epidemiology related publications by the team:\n\n\nAdd bibliography\nAdd bibliography\nAdd bibliography\nAdd bibliography"
  }
]